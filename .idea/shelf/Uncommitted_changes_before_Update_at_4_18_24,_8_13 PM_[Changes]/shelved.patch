Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"Black\">\n    <option name=\"sdkName\" value=\"$USER_HOME$/anaconda3\" />\n  </component>\n  <component name=\"ProjectRootManager\" version=\"2\" project-jdk-name=\"Python 3.11\" project-jdk-type=\"Python SDK\" />\n  <component name=\"PyCharmDSProjectLayout\">\n    <option name=\"id\" value=\"JupyterRightHiddenStructureLayout\" />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/misc.xml b/.idea/misc.xml
--- a/.idea/misc.xml	(revision 08a978e83fc64941c7ddcf70c3e64f3eabb379e1)
+++ b/.idea/misc.xml	(date 1713485550607)
@@ -1,9 +1,9 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
   <component name="Black">
-    <option name="sdkName" value="$USER_HOME$/anaconda3" />
+    <option name="sdkName" value="Python 3.9 (LLM-Debug-Assistant)" />
   </component>
-  <component name="ProjectRootManager" version="2" project-jdk-name="Python 3.11" project-jdk-type="Python SDK" />
+  <component name="ProjectRootManager" version="2" project-jdk-name="Python 3.9 (LLM-Debug-Assistant)" project-jdk-type="Python SDK" />
   <component name="PyCharmDSProjectLayout">
     <option name="id" value="JupyterRightHiddenStructureLayout" />
   </component>
Index: mock_client.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/mock_client.py b/mock_client.py
new file mode 100644
--- /dev/null	(date 1713485499698)
+++ b/mock_client.py	(date 1713485499698)
@@ -0,0 +1,23 @@
+import socket
+
+def run_client():
+    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as client:
+        server_ip = '127.0.0.1'
+        server_port = 8000
+        client.connect((server_ip, server_port))
+
+        while True:
+            msg = input("Enter message: ")
+            if msg.lower() == "exit":
+                client.sendall("close".encode("utf-8"))
+                break
+            client.sendall(msg.encode("utf-8"))
+            print("Awaiting response...")
+            while True:
+                token = client.recv(1024).decode("utf-8")
+                if token == "END":
+                    print("\nResponse complete.")
+                    break
+                print(token, end='')
+
+run_client()
Index: main.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n \"cells\": [\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 3,\n   \"metadata\": {\n    \"ExecuteTime\": {\n     \"end_time\": \"2024-03-21T22:53:59.330300Z\",\n     \"start_time\": \"2024-03-21T22:53:59.195848Z\"\n    }\n   },\n   \"outputs\": [\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"/Users/mesa/anaconda3/bin/python\\r\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"!which python\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 6,\n   \"metadata\": {\n    \"ExecuteTime\": {\n     \"end_time\": \"2024-03-21T22:56:41.702593Z\",\n     \"start_time\": \"2024-03-21T22:56:41.610436Z\"\n    }\n   },\n   \"outputs\": [\n    {\n     \"ename\": \"ImportError\",\n     \"evalue\": \"cannot import name 'DEFAULT_ETAG_TIMEOUT' from 'huggingface_hub.constants' (/Users/mesa/anaconda3/lib/python3.11/site-packages/huggingface_hub/constants.py)\",\n     \"output_type\": \"error\",\n     \"traceback\": [\n      \"\\u001B[0;31m---------------------------------------------------------------------------\\u001B[0m\",\n      \"\\u001B[0;31mImportError\\u001B[0m                               Traceback (most recent call last)\",\n      \"Cell \\u001B[0;32mIn[6], line 12\\u001B[0m\\n\\u001B[1;32m      3\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mdatasets\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m load_dataset\\n\\u001B[1;32m      4\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtransformers\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m (\\n\\u001B[1;32m      5\\u001B[0m     AutoModelForCausalLM,\\n\\u001B[1;32m      6\\u001B[0m     AutoTokenizer,\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     10\\u001B[0m     logging,\\n\\u001B[1;32m     11\\u001B[0m )\\n\\u001B[0;32m---> 12\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mpeft\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m LoraConfig\\n\\u001B[1;32m     13\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtrl\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m SFTTrainer\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/__init__.py:22\\u001B[0m\\n\\u001B[1;32m      1\\u001B[0m \\u001B[38;5;66;03m# flake8: noqa\\u001B[39;00m\\n\\u001B[1;32m      2\\u001B[0m \\u001B[38;5;66;03m# There's no way to ignore \\\"F401 '...' imported but unused\\\" warnings in this\\u001B[39;00m\\n\\u001B[1;32m      3\\u001B[0m \\u001B[38;5;66;03m# module, but to preserve other warnings. So, don't check this module at all.\\u001B[39;00m\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     17\\u001B[0m \\u001B[38;5;66;03m# See the License for the specific language governing permissions and\\u001B[39;00m\\n\\u001B[1;32m     18\\u001B[0m \\u001B[38;5;66;03m# limitations under the License.\\u001B[39;00m\\n\\u001B[1;32m     20\\u001B[0m __version__ \\u001B[38;5;241m=\\u001B[39m \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m0.10.0\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m\\n\\u001B[0;32m---> 22\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mauto\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m (\\n\\u001B[1;32m     23\\u001B[0m     AutoPeftModel,\\n\\u001B[1;32m     24\\u001B[0m     AutoPeftModelForCausalLM,\\n\\u001B[1;32m     25\\u001B[0m     AutoPeftModelForSequenceClassification,\\n\\u001B[1;32m     26\\u001B[0m     AutoPeftModelForSeq2SeqLM,\\n\\u001B[1;32m     27\\u001B[0m     AutoPeftModelForTokenClassification,\\n\\u001B[1;32m     28\\u001B[0m     AutoPeftModelForQuestionAnswering,\\n\\u001B[1;32m     29\\u001B[0m     AutoPeftModelForFeatureExtraction,\\n\\u001B[1;32m     30\\u001B[0m )\\n\\u001B[1;32m     31\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mmapping\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m (\\n\\u001B[1;32m     32\\u001B[0m     MODEL_TYPE_TO_PEFT_MODEL_MAPPING,\\n\\u001B[1;32m     33\\u001B[0m     PEFT_TYPE_TO_CONFIG_MAPPING,\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     36\\u001B[0m     inject_adapter_in_model,\\n\\u001B[1;32m     37\\u001B[0m )\\n\\u001B[1;32m     38\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mmixed_model\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m PeftMixedModel\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/auto.py:31\\u001B[0m\\n\\u001B[1;32m     19\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtyping\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m Optional\\n\\u001B[1;32m     21\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtransformers\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m (\\n\\u001B[1;32m     22\\u001B[0m     AutoModel,\\n\\u001B[1;32m     23\\u001B[0m     AutoModelForCausalLM,\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     28\\u001B[0m     AutoTokenizer,\\n\\u001B[1;32m     29\\u001B[0m )\\n\\u001B[0;32m---> 31\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mconfig\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m PeftConfig\\n\\u001B[1;32m     32\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mmapping\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m MODEL_TYPE_TO_PEFT_MODEL_MAPPING\\n\\u001B[1;32m     33\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mpeft_model\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m (\\n\\u001B[1;32m     34\\u001B[0m     PeftModel,\\n\\u001B[1;32m     35\\u001B[0m     PeftModelForCausalLM,\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     40\\u001B[0m     PeftModelForTokenClassification,\\n\\u001B[1;32m     41\\u001B[0m )\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/config.py:23\\u001B[0m\\n\\u001B[1;32m     20\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mhuggingface_hub\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m hf_hub_download\\n\\u001B[1;32m     21\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtransformers\\u001B[39;00m\\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mutils\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m PushToHubMixin\\n\\u001B[0;32m---> 23\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mutils\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m CONFIG_NAME, PeftType, TaskType\\n\\u001B[1;32m     26\\u001B[0m \\u001B[38;5;129m@dataclass\\u001B[39m\\n\\u001B[1;32m     27\\u001B[0m \\u001B[38;5;28;01mclass\\u001B[39;00m \\u001B[38;5;21;01mPeftConfigMixin\\u001B[39;00m(PushToHubMixin):\\n\\u001B[1;32m     28\\u001B[0m \\u001B[38;5;250m    \\u001B[39m\\u001B[38;5;124mr\\u001B[39m\\u001B[38;5;124;03m\\\"\\\"\\\"\\u001B[39;00m\\n\\u001B[1;32m     29\\u001B[0m \\u001B[38;5;124;03m    This is the base configuration class for PEFT adapter models. It contains all the methods that are common to all\\u001B[39;00m\\n\\u001B[1;32m     30\\u001B[0m \\u001B[38;5;124;03m    PEFT adapter models. This class inherits from [`~transformers.utils.PushToHubMixin`] which contains the methods to\\u001B[39;00m\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     35\\u001B[0m \\u001B[38;5;124;03m        peft_type (Union[[`~peft.utils.config.PeftType`], `str`]): The type of Peft method to use.\\u001B[39;00m\\n\\u001B[1;32m     36\\u001B[0m \\u001B[38;5;124;03m    \\\"\\\"\\\"\\u001B[39;00m\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/utils/__init__.py:21\\u001B[0m\\n\\u001B[1;32m      1\\u001B[0m \\u001B[38;5;66;03m# flake8: noqa\\u001B[39;00m\\n\\u001B[1;32m      2\\u001B[0m \\u001B[38;5;66;03m# There's no way to ignore \\\"F401 '...' imported but unused\\\" warnings in this\\u001B[39;00m\\n\\u001B[1;32m      3\\u001B[0m \\u001B[38;5;66;03m# module, but to preserve other warnings. So, don't check this module at all\\u001B[39;00m\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     19\\u001B[0m \\n\\u001B[1;32m     20\\u001B[0m \\u001B[38;5;66;03m# from .config import PeftConfig, PeftType, PromptLearningConfig, TaskType\\u001B[39;00m\\n\\u001B[0;32m---> 21\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mloftq_utils\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m replace_lora_weights_loftq\\n\\u001B[1;32m     22\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mpeft_types\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m PeftType, TaskType\\n\\u001B[1;32m     23\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mother\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m (\\n\\u001B[1;32m     24\\u001B[0m     TRANSFORMERS_MODELS_TO_PREFIX_TUNING_POSTPROCESS_MAPPING,\\n\\u001B[1;32m     25\\u001B[0m     TRANSFORMERS_MODELS_TO_LORA_TARGET_MODULES_MAPPING,\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m     50\\u001B[0m     cast_mixed_precision_params,\\n\\u001B[1;32m     51\\u001B[0m )\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/utils/loftq_utils.py:25\\u001B[0m\\n\\u001B[1;32m     22\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtyping\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m Callable, Optional, Union\\n\\u001B[1;32m     24\\u001B[0m \\u001B[38;5;28;01mimport\\u001B[39;00m \\u001B[38;5;21;01mtorch\\u001B[39;00m\\n\\u001B[0;32m---> 25\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mhuggingface_hub\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m snapshot_download\\n\\u001B[1;32m     26\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mhuggingface_hub\\u001B[39;00m\\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mutils\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m LocalEntryNotFoundError\\n\\u001B[1;32m     27\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01msafetensors\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m SafetensorError, safe_open\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/huggingface_hub/__init__.py:311\\u001B[0m, in \\u001B[0;36m__getattr__\\u001B[0;34m(name)\\u001B[0m\\n\\u001B[1;32m     49\\u001B[0m __version__ \\u001B[38;5;241m=\\u001B[39m \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m0.21.4\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m\\n\\u001B[1;32m     51\\u001B[0m \\u001B[38;5;66;03m# Alphabetical order of definitions is ensured in tests\\u001B[39;00m\\n\\u001B[1;32m     52\\u001B[0m \\u001B[38;5;66;03m# WARNING: any comment added in this dictionary definition will be lost when\\u001B[39;00m\\n\\u001B[1;32m     53\\u001B[0m \\u001B[38;5;66;03m# re-generating the file !\\u001B[39;00m\\n\\u001B[1;32m     54\\u001B[0m _SUBMOD_ATTRS \\u001B[38;5;241m=\\u001B[39m {\\n\\u001B[1;32m     55\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_commit_scheduler\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     56\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCommitScheduler\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     57\\u001B[0m     ],\\n\\u001B[1;32m     58\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_inference_endpoints\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     59\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceEndpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     60\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceEndpointError\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     61\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceEndpointStatus\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     62\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceEndpointTimeoutError\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     63\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceEndpointType\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     64\\u001B[0m     ],\\n\\u001B[1;32m     65\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_login\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     66\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124minterpreter_login\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     67\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlogin\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     68\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlogout\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     69\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mnotebook_login\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     70\\u001B[0m     ],\\n\\u001B[1;32m     71\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_multi_commits\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     72\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mMultiCommitException\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     73\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mplan_multi_commits\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     74\\u001B[0m     ],\\n\\u001B[1;32m     75\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_snapshot_download\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     76\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124msnapshot_download\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     77\\u001B[0m     ],\\n\\u001B[1;32m     78\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_space_api\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     79\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mSpaceHardware\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     80\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mSpaceRuntime\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     81\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mSpaceStage\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     82\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mSpaceStorage\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     83\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mSpaceVariable\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     84\\u001B[0m     ],\\n\\u001B[1;32m     85\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_tensorboard_logger\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     86\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHFSummaryWriter\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     87\\u001B[0m     ],\\n\\u001B[1;32m     88\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_webhooks_payload\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m     89\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayload\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     90\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadComment\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     91\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadDiscussion\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     92\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadDiscussionChanges\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     93\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadEvent\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     94\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadMovedTo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     95\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadRepo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     96\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadUrl\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     97\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhookPayloadWebhook\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m     98\\u001B[0m     ],\\n\\u001B[1;32m     99\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_webhooks_server\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    100\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mWebhooksServer\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    101\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mwebhook_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    102\\u001B[0m     ],\\n\\u001B[1;32m    103\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcommunity\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    104\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDiscussion\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    105\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDiscussionComment\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    106\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDiscussionCommit\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    107\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDiscussionEvent\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    108\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDiscussionStatusChange\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    109\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDiscussionTitleChange\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    110\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDiscussionWithDetails\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    111\\u001B[0m     ],\\n\\u001B[1;32m    112\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mconstants\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    113\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCONFIG_NAME\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    114\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mFLAX_WEIGHTS_NAME\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    115\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHUGGINGFACE_CO_URL_HOME\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    116\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHUGGINGFACE_CO_URL_TEMPLATE\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    117\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mPYTORCH_WEIGHTS_NAME\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    118\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mREPO_TYPE_DATASET\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    119\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mREPO_TYPE_MODEL\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    120\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mREPO_TYPE_SPACE\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    121\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mTF2_WEIGHTS_NAME\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    122\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mTF_WEIGHTS_NAME\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    123\\u001B[0m     ],\\n\\u001B[1;32m    124\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mfastai_utils\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    125\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_save_pretrained_fastai\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    126\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mfrom_pretrained_fastai\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    127\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mpush_to_hub_fastai\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    128\\u001B[0m     ],\\n\\u001B[1;32m    129\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mfile_download\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    130\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHfFileMetadata\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    131\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m_CACHED_NO_EXIST\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    132\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcached_download\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    133\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_hf_file_metadata\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    134\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mhf_hub_download\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    135\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mhf_hub_url\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    136\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mtry_to_load_from_cache\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    137\\u001B[0m     ],\\n\\u001B[1;32m    138\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mhf_api\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    139\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCollection\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    140\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCollectionItem\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    141\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCommitInfo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    142\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCommitOperation\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    143\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCommitOperationAdd\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    144\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCommitOperationCopy\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    145\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCommitOperationDelete\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    146\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mGitCommitInfo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    147\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mGitRefInfo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    148\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mGitRefs\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    149\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHfApi\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    150\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mRepoUrl\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    151\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mUser\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    152\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mUserLikes\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    153\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124maccept_access_request\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    154\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124madd_collection_item\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    155\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124madd_space_secret\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    156\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124madd_space_variable\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    157\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcancel_access_request\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    158\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mchange_discussion_status\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    159\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcomment_discussion\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    160\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_branch\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    161\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_collection\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    162\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_commit\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    163\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_commits_on_pr\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    164\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_discussion\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    165\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_inference_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    166\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_pull_request\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    167\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_repo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    168\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcreate_tag\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    169\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdataset_info\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    170\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_branch\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    171\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_collection\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    172\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_collection_item\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    173\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_file\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    174\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_folder\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    175\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_inference_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    176\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_repo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    177\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_space_secret\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    178\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_space_storage\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    179\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_space_variable\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    180\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdelete_tag\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    181\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mduplicate_space\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    182\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124medit_discussion_comment\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    183\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mfile_exists\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    184\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_collection\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    185\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_dataset_tags\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    186\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_discussion_details\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    187\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_full_repo_name\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    188\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_inference_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    189\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_model_tags\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    190\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_paths_info\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    191\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_repo_discussions\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    192\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_safetensors_metadata\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    193\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_space_runtime\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    194\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_space_variables\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    195\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_token_permission\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    196\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mgrant_access\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    197\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlike\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    198\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_accepted_access_requests\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    199\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_collections\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    200\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_datasets\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    201\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_files_info\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    202\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_inference_endpoints\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    203\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_liked_repos\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    204\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_metrics\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    205\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_models\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    206\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_pending_access_requests\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    207\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_rejected_access_requests\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    208\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_repo_commits\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    209\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_repo_files\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    210\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_repo_likers\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    211\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_repo_refs\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    212\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_repo_tree\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    213\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlist_spaces\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    214\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mmerge_pull_request\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    215\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mmodel_info\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    216\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mmove_repo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    217\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mparse_safetensors_file_metadata\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    218\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mpause_inference_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    219\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mpause_space\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    220\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mpreupload_lfs_files\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    221\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mreject_access_request\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    222\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrename_discussion\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    223\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrepo_exists\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    224\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrepo_info\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    225\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrepo_type_and_id_from_hf_id\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    226\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrequest_space_hardware\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    227\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrequest_space_storage\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    228\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrestart_space\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    229\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mresume_inference_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    230\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrevision_exists\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    231\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrun_as_future\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    232\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mscale_to_zero_inference_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    233\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mset_space_sleep_time\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    234\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mspace_info\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    235\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124msuper_squash_history\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    236\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124munlike\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    237\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mupdate_collection_item\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    238\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mupdate_collection_metadata\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    239\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mupdate_inference_endpoint\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    240\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mupdate_repo_visibility\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    241\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mupload_file\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    242\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mupload_folder\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    243\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mwhoami\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    244\\u001B[0m     ],\\n\\u001B[1;32m    245\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mhf_file_system\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    246\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHfFileSystem\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    247\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHfFileSystemFile\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    248\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHfFileSystemResolvedPath\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    249\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHfFileSystemStreamFile\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    250\\u001B[0m     ],\\n\\u001B[1;32m    251\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mhub_mixin\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    252\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mModelHubMixin\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    253\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mPyTorchModelHubMixin\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    254\\u001B[0m     ],\\n\\u001B[1;32m    255\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124minference._client\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    256\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceClient\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    257\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceTimeoutError\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    258\\u001B[0m     ],\\n\\u001B[1;32m    259\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124minference._generated._async_client\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    260\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mAsyncInferenceClient\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    261\\u001B[0m     ],\\n\\u001B[1;32m    262\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124minference_api\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    263\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mInferenceApi\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    264\\u001B[0m     ],\\n\\u001B[1;32m    265\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mkeras_mixin\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    266\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mKerasModelHubMixin\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    267\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mfrom_pretrained_keras\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    268\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mpush_to_hub_keras\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    269\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124msave_pretrained_keras\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    270\\u001B[0m     ],\\n\\u001B[1;32m    271\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrepocard\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    272\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDatasetCard\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    273\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mModelCard\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    274\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mRepoCard\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    275\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mSpaceCard\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    276\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mmetadata_eval_result\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    277\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mmetadata_load\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    278\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mmetadata_save\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    279\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mmetadata_update\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    280\\u001B[0m     ],\\n\\u001B[1;32m    281\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrepocard_data\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    282\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCardData\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    283\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDatasetCardData\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    284\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mEvalResult\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    285\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mModelCardData\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    286\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mSpaceCardData\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    287\\u001B[0m     ],\\n\\u001B[1;32m    288\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mrepository\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    289\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mRepository\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    290\\u001B[0m     ],\\n\\u001B[1;32m    291\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mserialization\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    292\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mStateDictSplit\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    293\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124msplit_numpy_state_dict_into_shards\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    294\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124msplit_state_dict_into_shards_factory\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    295\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124msplit_tf_state_dict_into_shards\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    296\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124msplit_torch_state_dict_into_shards\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    297\\u001B[0m     ],\\n\\u001B[1;32m    298\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mutils\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    299\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCacheNotFound\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    300\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCachedFileInfo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    301\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCachedRepoInfo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    302\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCachedRevisionInfo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    303\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mCorruptedCacheException\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    304\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDeleteCacheStrategy\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    305\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHFCacheInfo\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    306\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mHfFolder\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    307\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mcached_assets_path\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    308\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mconfigure_http_backend\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    309\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mdump_environment_info\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    310\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_session\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[0;32m--> 311\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mget_token\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    312\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mlogging\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    313\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mscan_cache_dir\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    314\\u001B[0m     ],\\n\\u001B[1;32m    315\\u001B[0m     \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mutils.endpoint_helpers\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: [\\n\\u001B[1;32m    316\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDatasetFilter\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    317\\u001B[0m         \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mModelFilter\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m,\\n\\u001B[1;32m    318\\u001B[0m     ],\\n\\u001B[1;32m    319\\u001B[0m }\\n\\u001B[1;32m    322\\u001B[0m \\u001B[38;5;28;01mdef\\u001B[39;00m \\u001B[38;5;21m_attach\\u001B[39m(package_name, submodules\\u001B[38;5;241m=\\u001B[39m\\u001B[38;5;28;01mNone\\u001B[39;00m, submod_attrs\\u001B[38;5;241m=\\u001B[39m\\u001B[38;5;28;01mNone\\u001B[39;00m):\\n\\u001B[1;32m    323\\u001B[0m \\u001B[38;5;250m    \\u001B[39m\\u001B[38;5;124;03m\\\"\\\"\\\"Attach lazily loaded submodules, functions, or other attributes.\\u001B[39;00m\\n\\u001B[1;32m    324\\u001B[0m \\n\\u001B[1;32m    325\\u001B[0m \\u001B[38;5;124;03m    Typically, modules import submodules and attributes as follows:\\u001B[39;00m\\n\\u001B[0;32m   (...)\\u001B[0m\\n\\u001B[1;32m    360\\u001B[0m \\n\\u001B[1;32m    361\\u001B[0m \\u001B[38;5;124;03m    \\\"\\\"\\\"\\u001B[39;00m\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/importlib/__init__.py:126\\u001B[0m, in \\u001B[0;36mimport_module\\u001B[0;34m(name, package)\\u001B[0m\\n\\u001B[1;32m    124\\u001B[0m             \\u001B[38;5;28;01mbreak\\u001B[39;00m\\n\\u001B[1;32m    125\\u001B[0m         level \\u001B[38;5;241m+\\u001B[39m\\u001B[38;5;241m=\\u001B[39m \\u001B[38;5;241m1\\u001B[39m\\n\\u001B[0;32m--> 126\\u001B[0m \\u001B[38;5;28;01mreturn\\u001B[39;00m _bootstrap\\u001B[38;5;241m.\\u001B[39m_gcd_import(name[level:], package, level)\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/huggingface_hub/_snapshot_download.py:9\\u001B[0m\\n\\u001B[1;32m      6\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtqdm\\u001B[39;00m\\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mauto\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m tqdm \\u001B[38;5;28;01mas\\u001B[39;00m base_tqdm\\n\\u001B[1;32m      7\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01mtqdm\\u001B[39;00m\\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mcontrib\\u001B[39;00m\\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mconcurrent\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m thread_map\\n\\u001B[0;32m----> 9\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mconstants\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m (\\n\\u001B[1;32m     10\\u001B[0m     DEFAULT_ETAG_TIMEOUT,\\n\\u001B[1;32m     11\\u001B[0m     DEFAULT_REVISION,\\n\\u001B[1;32m     12\\u001B[0m     HF_HUB_CACHE,\\n\\u001B[1;32m     13\\u001B[0m     HF_HUB_ENABLE_HF_TRANSFER,\\n\\u001B[1;32m     14\\u001B[0m     REPO_TYPES,\\n\\u001B[1;32m     15\\u001B[0m )\\n\\u001B[1;32m     16\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mfile_download\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m REGEX_COMMIT_HASH, hf_hub_download, repo_folder_name\\n\\u001B[1;32m     17\\u001B[0m \\u001B[38;5;28;01mfrom\\u001B[39;00m \\u001B[38;5;21;01m.\\u001B[39;00m\\u001B[38;5;21;01mhf_api\\u001B[39;00m \\u001B[38;5;28;01mimport\\u001B[39;00m DatasetInfo, HfApi, ModelInfo, SpaceInfo\\n\",\n      \"\\u001B[0;31mImportError\\u001B[0m: cannot import name 'DEFAULT_ETAG_TIMEOUT' from 'huggingface_hub.constants' (/Users/mesa/anaconda3/lib/python3.11/site-packages/huggingface_hub/constants.py)\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"import os\\n\",\n    \"import torch\\n\",\n    \"from datasets import load_dataset\\n\",\n    \"from transformers import (\\n\",\n    \"    AutoModelForCausalLM,\\n\",\n    \"    AutoTokenizer,\\n\",\n    \"    BitsAndBytesConfig,\\n\",\n    \"    TrainingArguments,\\n\",\n    \"    pipeline,\\n\",\n    \"    logging,\\n\",\n    \")\\n\",\n    \"from peft import LoraConfig\\n\",\n    \"from trl import SFTTrainer\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 7,\n   \"metadata\": {\n    \"ExecuteTime\": {\n     \"end_time\": \"2024-03-21T22:56:42.381639Z\",\n     \"start_time\": \"2024-03-21T22:56:42.379232Z\"\n    }\n   },\n   \"outputs\": [],\n   \"source\": [\n    \"# Model from Hugging Face hub\\n\",\n    \"base_model = \\\"NousResearch/Llama-2-7b-chat-hf\\\"\\n\",\n    \"\\n\",\n    \"# New instruction dataset\\n\",\n    \"stack_overflow_dataset = \\\"Mxode/StackOverflow-QA-C-Language-5k\\\"\\n\",\n    \"\\n\",\n    \"# Fine-tuned model\\n\",\n    \"new_model = \\\"llama-2-7b-chat-stack-overflow\\\"\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 8,\n   \"metadata\": {\n    \"ExecuteTime\": {\n     \"end_time\": \"2024-03-21T22:56:47.262734Z\",\n     \"start_time\": \"2024-03-21T22:56:44.031841Z\"\n    }\n   },\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/plain\": \"Downloading readme:   0%|          | 0.00/1.05k [00:00<?, ?B/s]\",\n      \"application/vnd.jupyter.widget-view+json\": {\n       \"version_major\": 2,\n       \"version_minor\": 0,\n       \"model_id\": \"0c104bc4bf83433a86ddec5dbf9319c8\"\n      }\n     },\n     \"metadata\": {},\n     \"output_type\": \"display_data\"\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"Downloading and preparing dataset json/Mxode--StackOverflow-QA-C-Language-5k to /Users/mesa/.cache/huggingface/datasets/Mxode___json/Mxode--StackOverflow-QA-C-Language-5k-4704a7b353a0f940/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4...\\n\"\n     ]\n    },\n    {\n     \"data\": {\n      \"text/plain\": \"Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]\",\n      \"application/vnd.jupyter.widget-view+json\": {\n       \"version_major\": 2,\n       \"version_minor\": 0,\n       \"model_id\": \"0e97fa8d64a4486cb0d351d03aefddd6\"\n      }\n     },\n     \"metadata\": {},\n     \"output_type\": \"display_data\"\n    },\n    {\n     \"data\": {\n      \"text/plain\": \"Downloading data:   0%|          | 0.00/2.05M [00:00<?, ?B/s]\",\n      \"application/vnd.jupyter.widget-view+json\": {\n       \"version_major\": 2,\n       \"version_minor\": 0,\n       \"model_id\": \"827fc14ba6a849499cb2991b82e8dd92\"\n      }\n     },\n     \"metadata\": {},\n     \"output_type\": \"display_data\"\n    },\n    {\n     \"data\": {\n      \"text/plain\": \"Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]\",\n      \"application/vnd.jupyter.widget-view+json\": {\n       \"version_major\": 2,\n       \"version_minor\": 0,\n       \"model_id\": \"037fef9cea0143879b8bfc54cc0f5d46\"\n      }\n     },\n     \"metadata\": {},\n     \"output_type\": \"display_data\"\n    },\n    {\n     \"data\": {\n      \"text/plain\": \"Generating train split: 0 examples [00:00, ? examples/s]\",\n      \"application/vnd.jupyter.widget-view+json\": {\n       \"version_major\": 2,\n       \"version_minor\": 0,\n       \"model_id\": \"f9062e21f0634a1dbd91369e06f8831d\"\n      }\n     },\n     \"metadata\": {},\n     \"output_type\": \"display_data\"\n    },\n    {\n     \"name\": \"stdout\",\n     \"output_type\": \"stream\",\n     \"text\": [\n      \"Dataset json downloaded and prepared to /Users/mesa/.cache/huggingface/datasets/Mxode___json/Mxode--StackOverflow-QA-C-Language-5k-4704a7b353a0f940/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4. Subsequent calls will reuse this data.\\n\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"dataset = load_dataset(stack_overflow_dataset, split=\\\"train\\\")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 9,\n   \"metadata\": {\n    \"ExecuteTime\": {\n     \"end_time\": \"2024-03-21T22:56:49.868081Z\",\n     \"start_time\": \"2024-03-21T22:56:49.787139Z\"\n    }\n   },\n   \"outputs\": [\n    {\n     \"data\": {\n      \"text/plain\": \"Map:   0%|          | 0/5151 [00:00<?, ? examples/s]\",\n      \"application/vnd.jupyter.widget-view+json\": {\n       \"version_major\": 2,\n       \"version_minor\": 0,\n       \"model_id\": \"c190633b24ec4e49bca0ad0bede4d775\"\n      }\n     },\n     \"metadata\": {},\n     \"output_type\": \"display_data\"\n    }\n   ],\n   \"source\": [\n    \"# dataset currently has 'question' and 'answer' columns. We need to combine them into a single column named 'text'\\n\",\n    \"dataset = dataset.map(\\n\",\n    \"    lambda examples: {\\n\",\n    \"        \\\"text\\\": \\\"<s>[INST]\\\" + examples[\\\"question\\\"] + \\\"[\\\\INST] \\\" + examples[\\\"answer\\\"] + \\\"</s>\\\",\\n\",\n    \"    }\\n\",\n    \")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 10,\n   \"metadata\": {\n    \"ExecuteTime\": {\n     \"end_time\": \"2024-03-21T22:56:51.690828Z\",\n     \"start_time\": \"2024-03-21T22:56:51.684052Z\"\n    }\n   },\n   \"outputs\": [],\n   \"source\": [\n    \"compute_dtype = getattr(torch, \\\"float16\\\")\\n\",\n    \"\\n\",\n    \"quant_config = BitsAndBytesConfig(\\n\",\n    \"    load_in_4bit=True,\\n\",\n    \"    bnb_4bit_quant_type=\\\"nf4\\\",\\n\",\n    \"    bnb_4bit_compute_dtype=compute_dtype,\\n\",\n    \"    bnb_4bit_use_double_quant=False,\\n\",\n    \")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": 11,\n   \"metadata\": {\n    \"ExecuteTime\": {\n     \"end_time\": \"2024-03-21T22:56:53.192388Z\",\n     \"start_time\": \"2024-03-21T22:56:52.671207Z\"\n    }\n   },\n   \"outputs\": [\n    {\n     \"ename\": \"ImportError\",\n     \"evalue\": \"Using `low_cpu_mem_usage=True` or a `device_map` requires Accelerate: `pip install accelerate`\",\n     \"output_type\": \"error\",\n     \"traceback\": [\n      \"\\u001B[0;31m---------------------------------------------------------------------------\\u001B[0m\",\n      \"\\u001B[0;31mImportError\\u001B[0m                               Traceback (most recent call last)\",\n      \"Cell \\u001B[0;32mIn[11], line 1\\u001B[0m\\n\\u001B[0;32m----> 1\\u001B[0m model \\u001B[38;5;241m=\\u001B[39m AutoModelForCausalLM\\u001B[38;5;241m.\\u001B[39mfrom_pretrained(\\n\\u001B[1;32m      2\\u001B[0m     base_model,\\n\\u001B[1;32m      3\\u001B[0m     quantization_config\\u001B[38;5;241m=\\u001B[39mquant_config,\\n\\u001B[1;32m      4\\u001B[0m     device_map\\u001B[38;5;241m=\\u001B[39m{\\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m: \\u001B[38;5;241m0\\u001B[39m}\\n\\u001B[1;32m      5\\u001B[0m )\\n\\u001B[1;32m      6\\u001B[0m model\\u001B[38;5;241m.\\u001B[39mconfig\\u001B[38;5;241m.\\u001B[39muse_cache \\u001B[38;5;241m=\\u001B[39m \\u001B[38;5;28;01mFalse\\u001B[39;00m\\n\\u001B[1;32m      7\\u001B[0m model\\u001B[38;5;241m.\\u001B[39mconfig\\u001B[38;5;241m.\\u001B[39mpretraining_tp \\u001B[38;5;241m=\\u001B[39m \\u001B[38;5;241m1\\u001B[39m\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/transformers/models/auto/auto_factory.py:516\\u001B[0m, in \\u001B[0;36m_BaseAutoModelClass.from_pretrained\\u001B[0;34m(cls, pretrained_model_name_or_path, *model_args, **kwargs)\\u001B[0m\\n\\u001B[1;32m    514\\u001B[0m \\u001B[38;5;28;01melif\\u001B[39;00m \\u001B[38;5;28mtype\\u001B[39m(config) \\u001B[38;5;129;01min\\u001B[39;00m \\u001B[38;5;28mcls\\u001B[39m\\u001B[38;5;241m.\\u001B[39m_model_mapping\\u001B[38;5;241m.\\u001B[39mkeys():\\n\\u001B[1;32m    515\\u001B[0m     model_class \\u001B[38;5;241m=\\u001B[39m _get_model_class(config, \\u001B[38;5;28mcls\\u001B[39m\\u001B[38;5;241m.\\u001B[39m_model_mapping)\\n\\u001B[0;32m--> 516\\u001B[0m     \\u001B[38;5;28;01mreturn\\u001B[39;00m model_class\\u001B[38;5;241m.\\u001B[39mfrom_pretrained(\\n\\u001B[1;32m    517\\u001B[0m         pretrained_model_name_or_path, \\u001B[38;5;241m*\\u001B[39mmodel_args, config\\u001B[38;5;241m=\\u001B[39mconfig, \\u001B[38;5;241m*\\u001B[39m\\u001B[38;5;241m*\\u001B[39mhub_kwargs, \\u001B[38;5;241m*\\u001B[39m\\u001B[38;5;241m*\\u001B[39mkwargs\\n\\u001B[1;32m    518\\u001B[0m     )\\n\\u001B[1;32m    519\\u001B[0m \\u001B[38;5;28;01mraise\\u001B[39;00m \\u001B[38;5;167;01mValueError\\u001B[39;00m(\\n\\u001B[1;32m    520\\u001B[0m     \\u001B[38;5;124mf\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mUnrecognized configuration class \\u001B[39m\\u001B[38;5;132;01m{\\u001B[39;00mconfig\\u001B[38;5;241m.\\u001B[39m\\u001B[38;5;18m__class__\\u001B[39m\\u001B[38;5;132;01m}\\u001B[39;00m\\u001B[38;5;124m for this kind of AutoModel: \\u001B[39m\\u001B[38;5;132;01m{\\u001B[39;00m\\u001B[38;5;28mcls\\u001B[39m\\u001B[38;5;241m.\\u001B[39m\\u001B[38;5;18m__name__\\u001B[39m\\u001B[38;5;132;01m}\\u001B[39;00m\\u001B[38;5;124m.\\u001B[39m\\u001B[38;5;130;01m\\\\n\\u001B[39;00m\\u001B[38;5;124m\\\"\\u001B[39m\\n\\u001B[1;32m    521\\u001B[0m     \\u001B[38;5;124mf\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mModel type should be one of \\u001B[39m\\u001B[38;5;132;01m{\\u001B[39;00m\\u001B[38;5;124m'\\u001B[39m\\u001B[38;5;124m, \\u001B[39m\\u001B[38;5;124m'\\u001B[39m\\u001B[38;5;241m.\\u001B[39mjoin(c\\u001B[38;5;241m.\\u001B[39m\\u001B[38;5;18m__name__\\u001B[39m\\u001B[38;5;250m \\u001B[39m\\u001B[38;5;28;01mfor\\u001B[39;00m\\u001B[38;5;250m \\u001B[39mc\\u001B[38;5;250m \\u001B[39m\\u001B[38;5;129;01min\\u001B[39;00m\\u001B[38;5;250m \\u001B[39m\\u001B[38;5;28mcls\\u001B[39m\\u001B[38;5;241m.\\u001B[39m_model_mapping\\u001B[38;5;241m.\\u001B[39mkeys())\\u001B[38;5;132;01m}\\u001B[39;00m\\u001B[38;5;124m.\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m\\n\\u001B[1;32m    522\\u001B[0m )\\n\",\n      \"File \\u001B[0;32m~/anaconda3/lib/python3.11/site-packages/transformers/modeling_utils.py:2368\\u001B[0m, in \\u001B[0;36mPreTrainedModel.from_pretrained\\u001B[0;34m(cls, pretrained_model_name_or_path, config, cache_dir, ignore_mismatched_sizes, force_download, local_files_only, token, revision, use_safetensors, *model_args, **kwargs)\\u001B[0m\\n\\u001B[1;32m   2364\\u001B[0m         \\u001B[38;5;28;01mraise\\u001B[39;00m \\u001B[38;5;167;01mValueError\\u001B[39;00m(\\n\\u001B[1;32m   2365\\u001B[0m             \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mDeepSpeed Zero-3 is not compatible with `low_cpu_mem_usage=True` or with passing a `device_map`.\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m\\n\\u001B[1;32m   2366\\u001B[0m         )\\n\\u001B[1;32m   2367\\u001B[0m     \\u001B[38;5;28;01melif\\u001B[39;00m \\u001B[38;5;129;01mnot\\u001B[39;00m is_accelerate_available():\\n\\u001B[0;32m-> 2368\\u001B[0m         \\u001B[38;5;28;01mraise\\u001B[39;00m \\u001B[38;5;167;01mImportError\\u001B[39;00m(\\n\\u001B[1;32m   2369\\u001B[0m             \\u001B[38;5;124m\\\"\\u001B[39m\\u001B[38;5;124mUsing `low_cpu_mem_usage=True` or a `device_map` requires Accelerate: `pip install accelerate`\\u001B[39m\\u001B[38;5;124m\\\"\\u001B[39m\\n\\u001B[1;32m   2370\\u001B[0m         )\\n\\u001B[1;32m   2372\\u001B[0m quantization_method_from_args \\u001B[38;5;241m=\\u001B[39m \\u001B[38;5;28;01mNone\\u001B[39;00m\\n\\u001B[1;32m   2373\\u001B[0m \\u001B[38;5;28;01mif\\u001B[39;00m quantization_config \\u001B[38;5;129;01mis\\u001B[39;00m \\u001B[38;5;129;01mnot\\u001B[39;00m \\u001B[38;5;28;01mNone\\u001B[39;00m:\\n\",\n      \"\\u001B[0;31mImportError\\u001B[0m: Using `low_cpu_mem_usage=True` or a `device_map` requires Accelerate: `pip install accelerate`\"\n     ]\n    }\n   ],\n   \"source\": [\n    \"model = AutoModelForCausalLM.from_pretrained(\\n\",\n    \"    base_model,\\n\",\n    \"    quantization_config=quant_config,\\n\",\n    \"    device_map={\\\"\\\": 0}\\n\",\n    \")\\n\",\n    \"model.config.use_cache = False\\n\",\n    \"model.config.pretraining_tp = 1\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"tokenizer = AutoTokenizer.from_pretrained(base_model, trust_remote_code=True)\\n\",\n    \"tokenizer.pad_token = tokenizer.eos_token\\n\",\n    \"tokenizer.padding_side = \\\"right\\\"\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"peft_params = LoraConfig(\\n\",\n    \"    lora_alpha=16,\\n\",\n    \"    lora_dropout=0.1,\\n\",\n    \"    r=64,\\n\",\n    \"    bias=\\\"none\\\",\\n\",\n    \"    task_type=\\\"CAUSAL_LM\\\",\\n\",\n    \")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"training_params = TrainingArguments(\\n\",\n    \"    output_dir=\\\"./results\\\",\\n\",\n    \"    num_train_epochs=1,\\n\",\n    \"    per_device_train_batch_size=4,\\n\",\n    \"    gradient_accumulation_steps=1,\\n\",\n    \"    optim=\\\"paged_adamw_32bit\\\",\\n\",\n    \"    save_steps=25,\\n\",\n    \"    logging_steps=25,\\n\",\n    \"    learning_rate=2e-4,\\n\",\n    \"    weight_decay=0.001,\\n\",\n    \"    fp16=False,\\n\",\n    \"    bf16=False,\\n\",\n    \"    max_grad_norm=0.3,\\n\",\n    \"    max_steps=-1,\\n\",\n    \"    warmup_ratio=0.03,\\n\",\n    \"    group_by_length=True,\\n\",\n    \"    lr_scheduler_type=\\\"constant\\\",\\n\",\n    \"    report_to=\\\"tensorboard\\\"\\n\",\n    \")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"trainer = SFTTrainer(\\n\",\n    \"    model=model,\\n\",\n    \"    train_dataset=dataset,\\n\",\n    \"    peft_config=peft_params,\\n\",\n    \"    dataset_text_field=\\\"text\\\",\\n\",\n    \"    max_seq_length=None,\\n\",\n    \"    tokenizer=tokenizer,\\n\",\n    \"    args=training_params,\\n\",\n    \"    packing=False,\\n\",\n    \")\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"trainer.model.save_pretrained(new_model)\\n\",\n    \"trainer.tokenizer.save_pretrained(new_model)\\n\"\n   ]\n  },\n  {\n   \"cell_type\": \"code\",\n   \"execution_count\": null,\n   \"metadata\": {},\n   \"outputs\": [],\n   \"source\": [\n    \"logging.set_verbosity(logging.CRITICAL)\\n\",\n    \"\\n\",\n    \"prompt = \\\"What is continuous integration?\\\"\\n\",\n    \"pipe = pipeline(task=\\\"text-generation\\\", model=model, tokenizer=tokenizer, max_length=200)\\n\",\n    \"result = pipe(f\\\"<s>[INST] {prompt} [/INST]\\\")\\n\",\n    \"print(result[0]['generated_text'])\"\n   ]\n  }\n ],\n \"metadata\": {\n  \"kernelspec\": {\n   \"display_name\": \"venv\",\n   \"language\": \"python\",\n   \"name\": \"python3\"\n  },\n  \"language_info\": {\n   \"codemirror_mode\": {\n    \"name\": \"ipython\",\n    \"version\": 3\n   },\n   \"file_extension\": \".py\",\n   \"mimetype\": \"text/x-python\",\n   \"name\": \"python\",\n   \"nbconvert_exporter\": \"python\",\n   \"pygments_lexer\": \"ipython3\",\n   \"version\": \"3.10.12\"\n  }\n },\n \"nbformat\": 4,\n \"nbformat_minor\": 2\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.ipynb b/main.ipynb
--- a/main.ipynb	(revision 08a978e83fc64941c7ddcf70c3e64f3eabb379e1)
+++ b/main.ipynb	(date 1713485550157)
@@ -2,19 +2,24 @@
  "cells": [
   {
    "cell_type": "code",
-   "execution_count": 3,
+   "execution_count": 1,
    "metadata": {
     "ExecuteTime": {
-     "end_time": "2024-03-21T22:53:59.330300Z",
-     "start_time": "2024-03-21T22:53:59.195848Z"
-    }
+     "end_time": "2024-03-28T21:29:07.974342Z",
+     "start_time": "2024-03-28T21:29:07.858237Z"
+    },
+    "colab": {
+     "base_uri": "https://localhost:8080/"
+    },
+    "id": "puZgvM8r0aJx",
+    "outputId": "ebdb2225-aa01-4a30-9994-e9c186c69751"
    },
    "outputs": [
     {
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "/Users/mesa/anaconda3/bin/python\r\n"
+      "/home/bgsmagnuson/Documents/code_py/LLM-Debug-Assistant/venv/bin/python\n"
      ]
     }
    ],
@@ -24,34 +29,9 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 6,
-   "metadata": {
-    "ExecuteTime": {
-     "end_time": "2024-03-21T22:56:41.702593Z",
-     "start_time": "2024-03-21T22:56:41.610436Z"
-    }
-   },
-   "outputs": [
-    {
-     "ename": "ImportError",
-     "evalue": "cannot import name 'DEFAULT_ETAG_TIMEOUT' from 'huggingface_hub.constants' (/Users/mesa/anaconda3/lib/python3.11/site-packages/huggingface_hub/constants.py)",
-     "output_type": "error",
-     "traceback": [
-      "\u001B[0;31m---------------------------------------------------------------------------\u001B[0m",
-      "\u001B[0;31mImportError\u001B[0m                               Traceback (most recent call last)",
-      "Cell \u001B[0;32mIn[6], line 12\u001B[0m\n\u001B[1;32m      3\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mdatasets\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m load_dataset\n\u001B[1;32m      4\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtransformers\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m (\n\u001B[1;32m      5\u001B[0m     AutoModelForCausalLM,\n\u001B[1;32m      6\u001B[0m     AutoTokenizer,\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     10\u001B[0m     logging,\n\u001B[1;32m     11\u001B[0m )\n\u001B[0;32m---> 12\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mpeft\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m LoraConfig\n\u001B[1;32m     13\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtrl\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m SFTTrainer\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/__init__.py:22\u001B[0m\n\u001B[1;32m      1\u001B[0m \u001B[38;5;66;03m# flake8: noqa\u001B[39;00m\n\u001B[1;32m      2\u001B[0m \u001B[38;5;66;03m# There's no way to ignore \"F401 '...' imported but unused\" warnings in this\u001B[39;00m\n\u001B[1;32m      3\u001B[0m \u001B[38;5;66;03m# module, but to preserve other warnings. So, don't check this module at all.\u001B[39;00m\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     17\u001B[0m \u001B[38;5;66;03m# See the License for the specific language governing permissions and\u001B[39;00m\n\u001B[1;32m     18\u001B[0m \u001B[38;5;66;03m# limitations under the License.\u001B[39;00m\n\u001B[1;32m     20\u001B[0m __version__ \u001B[38;5;241m=\u001B[39m \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m0.10.0\u001B[39m\u001B[38;5;124m\"\u001B[39m\n\u001B[0;32m---> 22\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mauto\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m (\n\u001B[1;32m     23\u001B[0m     AutoPeftModel,\n\u001B[1;32m     24\u001B[0m     AutoPeftModelForCausalLM,\n\u001B[1;32m     25\u001B[0m     AutoPeftModelForSequenceClassification,\n\u001B[1;32m     26\u001B[0m     AutoPeftModelForSeq2SeqLM,\n\u001B[1;32m     27\u001B[0m     AutoPeftModelForTokenClassification,\n\u001B[1;32m     28\u001B[0m     AutoPeftModelForQuestionAnswering,\n\u001B[1;32m     29\u001B[0m     AutoPeftModelForFeatureExtraction,\n\u001B[1;32m     30\u001B[0m )\n\u001B[1;32m     31\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mmapping\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m (\n\u001B[1;32m     32\u001B[0m     MODEL_TYPE_TO_PEFT_MODEL_MAPPING,\n\u001B[1;32m     33\u001B[0m     PEFT_TYPE_TO_CONFIG_MAPPING,\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     36\u001B[0m     inject_adapter_in_model,\n\u001B[1;32m     37\u001B[0m )\n\u001B[1;32m     38\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mmixed_model\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m PeftMixedModel\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/auto.py:31\u001B[0m\n\u001B[1;32m     19\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtyping\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m Optional\n\u001B[1;32m     21\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtransformers\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m (\n\u001B[1;32m     22\u001B[0m     AutoModel,\n\u001B[1;32m     23\u001B[0m     AutoModelForCausalLM,\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     28\u001B[0m     AutoTokenizer,\n\u001B[1;32m     29\u001B[0m )\n\u001B[0;32m---> 31\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mconfig\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m PeftConfig\n\u001B[1;32m     32\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mmapping\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m MODEL_TYPE_TO_PEFT_MODEL_MAPPING\n\u001B[1;32m     33\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mpeft_model\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m (\n\u001B[1;32m     34\u001B[0m     PeftModel,\n\u001B[1;32m     35\u001B[0m     PeftModelForCausalLM,\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     40\u001B[0m     PeftModelForTokenClassification,\n\u001B[1;32m     41\u001B[0m )\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/config.py:23\u001B[0m\n\u001B[1;32m     20\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mhuggingface_hub\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m hf_hub_download\n\u001B[1;32m     21\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtransformers\u001B[39;00m\u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mutils\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m PushToHubMixin\n\u001B[0;32m---> 23\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mutils\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m CONFIG_NAME, PeftType, TaskType\n\u001B[1;32m     26\u001B[0m \u001B[38;5;129m@dataclass\u001B[39m\n\u001B[1;32m     27\u001B[0m \u001B[38;5;28;01mclass\u001B[39;00m \u001B[38;5;21;01mPeftConfigMixin\u001B[39;00m(PushToHubMixin):\n\u001B[1;32m     28\u001B[0m \u001B[38;5;250m    \u001B[39m\u001B[38;5;124mr\u001B[39m\u001B[38;5;124;03m\"\"\"\u001B[39;00m\n\u001B[1;32m     29\u001B[0m \u001B[38;5;124;03m    This is the base configuration class for PEFT adapter models. It contains all the methods that are common to all\u001B[39;00m\n\u001B[1;32m     30\u001B[0m \u001B[38;5;124;03m    PEFT adapter models. This class inherits from [`~transformers.utils.PushToHubMixin`] which contains the methods to\u001B[39;00m\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     35\u001B[0m \u001B[38;5;124;03m        peft_type (Union[[`~peft.utils.config.PeftType`], `str`]): The type of Peft method to use.\u001B[39;00m\n\u001B[1;32m     36\u001B[0m \u001B[38;5;124;03m    \"\"\"\u001B[39;00m\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/utils/__init__.py:21\u001B[0m\n\u001B[1;32m      1\u001B[0m \u001B[38;5;66;03m# flake8: noqa\u001B[39;00m\n\u001B[1;32m      2\u001B[0m \u001B[38;5;66;03m# There's no way to ignore \"F401 '...' imported but unused\" warnings in this\u001B[39;00m\n\u001B[1;32m      3\u001B[0m \u001B[38;5;66;03m# module, but to preserve other warnings. So, don't check this module at all\u001B[39;00m\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     19\u001B[0m \n\u001B[1;32m     20\u001B[0m \u001B[38;5;66;03m# from .config import PeftConfig, PeftType, PromptLearningConfig, TaskType\u001B[39;00m\n\u001B[0;32m---> 21\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mloftq_utils\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m replace_lora_weights_loftq\n\u001B[1;32m     22\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mpeft_types\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m PeftType, TaskType\n\u001B[1;32m     23\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mother\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m (\n\u001B[1;32m     24\u001B[0m     TRANSFORMERS_MODELS_TO_PREFIX_TUNING_POSTPROCESS_MAPPING,\n\u001B[1;32m     25\u001B[0m     TRANSFORMERS_MODELS_TO_LORA_TARGET_MODULES_MAPPING,\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m     50\u001B[0m     cast_mixed_precision_params,\n\u001B[1;32m     51\u001B[0m )\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/peft/utils/loftq_utils.py:25\u001B[0m\n\u001B[1;32m     22\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtyping\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m Callable, Optional, Union\n\u001B[1;32m     24\u001B[0m \u001B[38;5;28;01mimport\u001B[39;00m \u001B[38;5;21;01mtorch\u001B[39;00m\n\u001B[0;32m---> 25\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mhuggingface_hub\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m snapshot_download\n\u001B[1;32m     26\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mhuggingface_hub\u001B[39;00m\u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mutils\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m LocalEntryNotFoundError\n\u001B[1;32m     27\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01msafetensors\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m SafetensorError, safe_open\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/huggingface_hub/__init__.py:311\u001B[0m, in \u001B[0;36m__getattr__\u001B[0;34m(name)\u001B[0m\n\u001B[1;32m     49\u001B[0m __version__ \u001B[38;5;241m=\u001B[39m \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m0.21.4\u001B[39m\u001B[38;5;124m\"\u001B[39m\n\u001B[1;32m     51\u001B[0m \u001B[38;5;66;03m# Alphabetical order of definitions is ensured in tests\u001B[39;00m\n\u001B[1;32m     52\u001B[0m \u001B[38;5;66;03m# WARNING: any comment added in this dictionary definition will be lost when\u001B[39;00m\n\u001B[1;32m     53\u001B[0m \u001B[38;5;66;03m# re-generating the file !\u001B[39;00m\n\u001B[1;32m     54\u001B[0m _SUBMOD_ATTRS \u001B[38;5;241m=\u001B[39m {\n\u001B[1;32m     55\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_commit_scheduler\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     56\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCommitScheduler\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     57\u001B[0m     ],\n\u001B[1;32m     58\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_inference_endpoints\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     59\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceEndpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     60\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceEndpointError\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     61\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceEndpointStatus\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     62\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceEndpointTimeoutError\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     63\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceEndpointType\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     64\u001B[0m     ],\n\u001B[1;32m     65\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_login\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     66\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124minterpreter_login\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     67\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlogin\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     68\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlogout\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     69\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mnotebook_login\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     70\u001B[0m     ],\n\u001B[1;32m     71\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_multi_commits\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     72\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mMultiCommitException\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     73\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mplan_multi_commits\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     74\u001B[0m     ],\n\u001B[1;32m     75\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_snapshot_download\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     76\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124msnapshot_download\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     77\u001B[0m     ],\n\u001B[1;32m     78\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_space_api\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     79\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mSpaceHardware\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     80\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mSpaceRuntime\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     81\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mSpaceStage\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     82\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mSpaceStorage\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     83\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mSpaceVariable\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     84\u001B[0m     ],\n\u001B[1;32m     85\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_tensorboard_logger\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     86\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHFSummaryWriter\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     87\u001B[0m     ],\n\u001B[1;32m     88\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_webhooks_payload\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m     89\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayload\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     90\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadComment\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     91\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadDiscussion\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     92\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadDiscussionChanges\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     93\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadEvent\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     94\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadMovedTo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     95\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadRepo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     96\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadUrl\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     97\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhookPayloadWebhook\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m     98\u001B[0m     ],\n\u001B[1;32m     99\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_webhooks_server\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    100\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mWebhooksServer\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    101\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mwebhook_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    102\u001B[0m     ],\n\u001B[1;32m    103\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcommunity\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    104\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDiscussion\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    105\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDiscussionComment\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    106\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDiscussionCommit\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    107\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDiscussionEvent\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    108\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDiscussionStatusChange\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    109\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDiscussionTitleChange\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    110\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDiscussionWithDetails\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    111\u001B[0m     ],\n\u001B[1;32m    112\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mconstants\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    113\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCONFIG_NAME\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    114\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mFLAX_WEIGHTS_NAME\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    115\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHUGGINGFACE_CO_URL_HOME\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    116\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHUGGINGFACE_CO_URL_TEMPLATE\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    117\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mPYTORCH_WEIGHTS_NAME\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    118\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mREPO_TYPE_DATASET\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    119\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mREPO_TYPE_MODEL\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    120\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mREPO_TYPE_SPACE\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    121\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mTF2_WEIGHTS_NAME\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    122\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mTF_WEIGHTS_NAME\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    123\u001B[0m     ],\n\u001B[1;32m    124\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mfastai_utils\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    125\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_save_pretrained_fastai\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    126\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mfrom_pretrained_fastai\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    127\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mpush_to_hub_fastai\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    128\u001B[0m     ],\n\u001B[1;32m    129\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mfile_download\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    130\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHfFileMetadata\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    131\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m_CACHED_NO_EXIST\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    132\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcached_download\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    133\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_hf_file_metadata\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    134\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mhf_hub_download\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    135\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mhf_hub_url\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    136\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mtry_to_load_from_cache\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    137\u001B[0m     ],\n\u001B[1;32m    138\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mhf_api\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    139\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCollection\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    140\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCollectionItem\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    141\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCommitInfo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    142\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCommitOperation\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    143\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCommitOperationAdd\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    144\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCommitOperationCopy\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    145\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCommitOperationDelete\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    146\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mGitCommitInfo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    147\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mGitRefInfo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    148\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mGitRefs\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    149\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHfApi\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    150\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mRepoUrl\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    151\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mUser\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    152\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mUserLikes\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    153\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124maccept_access_request\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    154\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124madd_collection_item\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    155\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124madd_space_secret\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    156\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124madd_space_variable\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    157\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcancel_access_request\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    158\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mchange_discussion_status\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    159\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcomment_discussion\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    160\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_branch\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    161\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_collection\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    162\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_commit\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    163\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_commits_on_pr\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    164\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_discussion\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    165\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_inference_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    166\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_pull_request\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    167\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_repo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    168\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcreate_tag\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    169\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdataset_info\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    170\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_branch\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    171\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_collection\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    172\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_collection_item\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    173\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_file\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    174\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_folder\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    175\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_inference_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    176\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_repo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    177\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_space_secret\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    178\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_space_storage\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    179\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_space_variable\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    180\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdelete_tag\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    181\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mduplicate_space\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    182\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124medit_discussion_comment\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    183\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mfile_exists\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    184\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_collection\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    185\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_dataset_tags\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    186\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_discussion_details\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    187\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_full_repo_name\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    188\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_inference_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    189\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_model_tags\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    190\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_paths_info\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    191\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_repo_discussions\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    192\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_safetensors_metadata\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    193\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_space_runtime\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    194\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_space_variables\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    195\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_token_permission\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    196\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mgrant_access\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    197\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlike\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    198\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_accepted_access_requests\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    199\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_collections\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    200\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_datasets\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    201\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_files_info\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    202\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_inference_endpoints\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    203\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_liked_repos\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    204\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_metrics\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    205\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_models\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    206\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_pending_access_requests\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    207\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_rejected_access_requests\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    208\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_repo_commits\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    209\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_repo_files\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    210\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_repo_likers\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    211\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_repo_refs\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    212\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_repo_tree\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    213\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlist_spaces\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    214\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmerge_pull_request\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    215\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmodel_info\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    216\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmove_repo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    217\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mparse_safetensors_file_metadata\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    218\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mpause_inference_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    219\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mpause_space\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    220\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mpreupload_lfs_files\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    221\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mreject_access_request\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    222\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrename_discussion\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    223\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrepo_exists\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    224\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrepo_info\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    225\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrepo_type_and_id_from_hf_id\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    226\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrequest_space_hardware\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    227\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrequest_space_storage\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    228\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrestart_space\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    229\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mresume_inference_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    230\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrevision_exists\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    231\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrun_as_future\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    232\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mscale_to_zero_inference_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    233\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mset_space_sleep_time\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    234\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mspace_info\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    235\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124msuper_squash_history\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    236\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124munlike\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    237\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mupdate_collection_item\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    238\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mupdate_collection_metadata\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    239\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mupdate_inference_endpoint\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    240\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mupdate_repo_visibility\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    241\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mupload_file\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    242\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mupload_folder\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    243\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mwhoami\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    244\u001B[0m     ],\n\u001B[1;32m    245\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mhf_file_system\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    246\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHfFileSystem\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    247\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHfFileSystemFile\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    248\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHfFileSystemResolvedPath\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    249\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHfFileSystemStreamFile\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    250\u001B[0m     ],\n\u001B[1;32m    251\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mhub_mixin\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    252\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mModelHubMixin\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    253\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mPyTorchModelHubMixin\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    254\u001B[0m     ],\n\u001B[1;32m    255\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124minference._client\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    256\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceClient\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    257\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceTimeoutError\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    258\u001B[0m     ],\n\u001B[1;32m    259\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124minference._generated._async_client\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    260\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mAsyncInferenceClient\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    261\u001B[0m     ],\n\u001B[1;32m    262\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124minference_api\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    263\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mInferenceApi\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    264\u001B[0m     ],\n\u001B[1;32m    265\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mkeras_mixin\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    266\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mKerasModelHubMixin\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    267\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mfrom_pretrained_keras\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    268\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mpush_to_hub_keras\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    269\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124msave_pretrained_keras\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    270\u001B[0m     ],\n\u001B[1;32m    271\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrepocard\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    272\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDatasetCard\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    273\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mModelCard\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    274\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mRepoCard\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    275\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mSpaceCard\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    276\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmetadata_eval_result\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    277\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmetadata_load\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    278\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmetadata_save\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    279\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmetadata_update\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    280\u001B[0m     ],\n\u001B[1;32m    281\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrepocard_data\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    282\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCardData\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    283\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDatasetCardData\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    284\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mEvalResult\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    285\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mModelCardData\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    286\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mSpaceCardData\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    287\u001B[0m     ],\n\u001B[1;32m    288\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mrepository\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    289\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mRepository\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    290\u001B[0m     ],\n\u001B[1;32m    291\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mserialization\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    292\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mStateDictSplit\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    293\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124msplit_numpy_state_dict_into_shards\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    294\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124msplit_state_dict_into_shards_factory\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    295\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124msplit_tf_state_dict_into_shards\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    296\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124msplit_torch_state_dict_into_shards\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    297\u001B[0m     ],\n\u001B[1;32m    298\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mutils\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    299\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCacheNotFound\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    300\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCachedFileInfo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    301\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCachedRepoInfo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    302\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCachedRevisionInfo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    303\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCorruptedCacheException\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    304\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDeleteCacheStrategy\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    305\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHFCacheInfo\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    306\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mHfFolder\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    307\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mcached_assets_path\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    308\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mconfigure_http_backend\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    309\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mdump_environment_info\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    310\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_session\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[0;32m--> 311\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mget_token\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    312\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mlogging\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    313\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mscan_cache_dir\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    314\u001B[0m     ],\n\u001B[1;32m    315\u001B[0m     \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mutils.endpoint_helpers\u001B[39m\u001B[38;5;124m\"\u001B[39m: [\n\u001B[1;32m    316\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDatasetFilter\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    317\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mModelFilter\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    318\u001B[0m     ],\n\u001B[1;32m    319\u001B[0m }\n\u001B[1;32m    322\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21m_attach\u001B[39m(package_name, submodules\u001B[38;5;241m=\u001B[39m\u001B[38;5;28;01mNone\u001B[39;00m, submod_attrs\u001B[38;5;241m=\u001B[39m\u001B[38;5;28;01mNone\u001B[39;00m):\n\u001B[1;32m    323\u001B[0m \u001B[38;5;250m    \u001B[39m\u001B[38;5;124;03m\"\"\"Attach lazily loaded submodules, functions, or other attributes.\u001B[39;00m\n\u001B[1;32m    324\u001B[0m \n\u001B[1;32m    325\u001B[0m \u001B[38;5;124;03m    Typically, modules import submodules and attributes as follows:\u001B[39;00m\n\u001B[0;32m   (...)\u001B[0m\n\u001B[1;32m    360\u001B[0m \n\u001B[1;32m    361\u001B[0m \u001B[38;5;124;03m    \"\"\"\u001B[39;00m\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/importlib/__init__.py:126\u001B[0m, in \u001B[0;36mimport_module\u001B[0;34m(name, package)\u001B[0m\n\u001B[1;32m    124\u001B[0m             \u001B[38;5;28;01mbreak\u001B[39;00m\n\u001B[1;32m    125\u001B[0m         level \u001B[38;5;241m+\u001B[39m\u001B[38;5;241m=\u001B[39m \u001B[38;5;241m1\u001B[39m\n\u001B[0;32m--> 126\u001B[0m \u001B[38;5;28;01mreturn\u001B[39;00m _bootstrap\u001B[38;5;241m.\u001B[39m_gcd_import(name[level:], package, level)\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/huggingface_hub/_snapshot_download.py:9\u001B[0m\n\u001B[1;32m      6\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtqdm\u001B[39;00m\u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mauto\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m tqdm \u001B[38;5;28;01mas\u001B[39;00m base_tqdm\n\u001B[1;32m      7\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01mtqdm\u001B[39;00m\u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mcontrib\u001B[39;00m\u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mconcurrent\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m thread_map\n\u001B[0;32m----> 9\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mconstants\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m (\n\u001B[1;32m     10\u001B[0m     DEFAULT_ETAG_TIMEOUT,\n\u001B[1;32m     11\u001B[0m     DEFAULT_REVISION,\n\u001B[1;32m     12\u001B[0m     HF_HUB_CACHE,\n\u001B[1;32m     13\u001B[0m     HF_HUB_ENABLE_HF_TRANSFER,\n\u001B[1;32m     14\u001B[0m     REPO_TYPES,\n\u001B[1;32m     15\u001B[0m )\n\u001B[1;32m     16\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mfile_download\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m REGEX_COMMIT_HASH, hf_hub_download, repo_folder_name\n\u001B[1;32m     17\u001B[0m \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;21;01m.\u001B[39;00m\u001B[38;5;21;01mhf_api\u001B[39;00m \u001B[38;5;28;01mimport\u001B[39;00m DatasetInfo, HfApi, ModelInfo, SpaceInfo\n",
-      "\u001B[0;31mImportError\u001B[0m: cannot import name 'DEFAULT_ETAG_TIMEOUT' from 'huggingface_hub.constants' (/Users/mesa/anaconda3/lib/python3.11/site-packages/huggingface_hub/constants.py)"
-     ]
-    }
-   ],
+   "execution_count": 2,
+   "metadata": {},
+   "outputs": [],
    "source": [
     "import os\n",
     "import torch\n",
@@ -70,20 +50,21 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 7,
+   "execution_count": 3,
    "metadata": {
     "ExecuteTime": {
-     "end_time": "2024-03-21T22:56:42.381639Z",
-     "start_time": "2024-03-21T22:56:42.379232Z"
-    }
+     "end_time": "2024-03-29T01:52:40.995550Z",
+     "start_time": "2024-03-29T01:52:40.992696Z"
+    },
+    "id": "6Oi4Ha2-0aJy"
    },
    "outputs": [],
    "source": [
     "# Model from Hugging Face hub\n",
-    "base_model = \"NousResearch/Llama-2-7b-chat-hf\"\n",
-    "\n",
+    "base_model = \"TinyLlama/TinyLlama-1.1B-Chat-v1.0\"\n",
     "# New instruction dataset\n",
-    "stack_overflow_dataset = \"Mxode/StackOverflow-QA-C-Language-5k\"\n",
+    "stack_overflow_dataset = \"Mxode/StackOverflow-QA-C-Language-40k\"\n",
+    "code_feedback_dataset = \"m-a-p/CodeFeedback-Filtered-Instruction\"\n",
     "\n",
     "# Fine-tuned model\n",
     "new_model = \"llama-2-7b-chat-stack-overflow\""
@@ -91,134 +72,41 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 8,
-   "metadata": {
-    "ExecuteTime": {
-     "end_time": "2024-03-21T22:56:47.262734Z",
-     "start_time": "2024-03-21T22:56:44.031841Z"
-    }
-   },
-   "outputs": [
-    {
-     "data": {
-      "text/plain": "Downloading readme:   0%|          | 0.00/1.05k [00:00<?, ?B/s]",
-      "application/vnd.jupyter.widget-view+json": {
-       "version_major": 2,
-       "version_minor": 0,
-       "model_id": "0c104bc4bf83433a86ddec5dbf9319c8"
-      }
-     },
-     "metadata": {},
-     "output_type": "display_data"
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "Downloading and preparing dataset json/Mxode--StackOverflow-QA-C-Language-5k to /Users/mesa/.cache/huggingface/datasets/Mxode___json/Mxode--StackOverflow-QA-C-Language-5k-4704a7b353a0f940/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4...\n"
-     ]
-    },
-    {
-     "data": {
-      "text/plain": "Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]",
-      "application/vnd.jupyter.widget-view+json": {
-       "version_major": 2,
-       "version_minor": 0,
-       "model_id": "0e97fa8d64a4486cb0d351d03aefddd6"
-      }
-     },
-     "metadata": {},
-     "output_type": "display_data"
-    },
-    {
-     "data": {
-      "text/plain": "Downloading data:   0%|          | 0.00/2.05M [00:00<?, ?B/s]",
-      "application/vnd.jupyter.widget-view+json": {
-       "version_major": 2,
-       "version_minor": 0,
-       "model_id": "827fc14ba6a849499cb2991b82e8dd92"
-      }
-     },
-     "metadata": {},
-     "output_type": "display_data"
-    },
-    {
-     "data": {
-      "text/plain": "Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]",
-      "application/vnd.jupyter.widget-view+json": {
-       "version_major": 2,
-       "version_minor": 0,
-       "model_id": "037fef9cea0143879b8bfc54cc0f5d46"
-      }
-     },
-     "metadata": {},
-     "output_type": "display_data"
-    },
-    {
-     "data": {
-      "text/plain": "Generating train split: 0 examples [00:00, ? examples/s]",
-      "application/vnd.jupyter.widget-view+json": {
-       "version_major": 2,
-       "version_minor": 0,
-       "model_id": "f9062e21f0634a1dbd91369e06f8831d"
-      }
-     },
-     "metadata": {},
-     "output_type": "display_data"
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "Dataset json downloaded and prepared to /Users/mesa/.cache/huggingface/datasets/Mxode___json/Mxode--StackOverflow-QA-C-Language-5k-4704a7b353a0f940/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4. Subsequent calls will reuse this data.\n"
-     ]
-    }
-   ],
+   "execution_count": 4,
+   "metadata": {},
+   "outputs": [],
    "source": [
-    "dataset = load_dataset(stack_overflow_dataset, split=\"train\")"
+    "dataset = load_dataset(code_feedback_dataset, split=\"train\")\n",
+    "dataset = dataset.shuffle(seed=42)"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 9,
+   "execution_count": 5,
    "metadata": {
     "ExecuteTime": {
-     "end_time": "2024-03-21T22:56:49.868081Z",
-     "start_time": "2024-03-21T22:56:49.787139Z"
-    }
-   },
-   "outputs": [
-    {
-     "data": {
-      "text/plain": "Map:   0%|          | 0/5151 [00:00<?, ? examples/s]",
-      "application/vnd.jupyter.widget-view+json": {
-       "version_major": 2,
-       "version_minor": 0,
-       "model_id": "c190633b24ec4e49bca0ad0bede4d775"
-      }
-     },
-     "metadata": {},
-     "output_type": "display_data"
-    }
-   ],
+     "end_time": "2024-03-29T01:52:56.810637Z",
+     "start_time": "2024-03-29T01:52:55.907172Z"
+    },
+    "id": "-TEmF43d0aJy"
+   },
+   "outputs": [],
    "source": [
     "# dataset currently has 'question' and 'answer' columns. We need to combine them into a single column named 'text'\n",
     "dataset = dataset.map(\n",
     "    lambda examples: {\n",
-    "        \"text\": \"<s>[INST]\" + examples[\"question\"] + \"[\\INST] \" + examples[\"answer\"] + \"</s>\",\n",
+    "        \"text\": \"<s>[INST]\" + examples[\"query\"] + \"[\\INST] \" + examples[\"answer\"] + \"</s>\",\n",
     "    }\n",
-    ")"
+    ")\n",
+    "# Select only 40000 examples\n",
+    "trunc_dataset = dataset.select(range(40000))\n",
+    "del dataset"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 10,
-   "metadata": {
-    "ExecuteTime": {
-     "end_time": "2024-03-21T22:56:51.690828Z",
-     "start_time": "2024-03-21T22:56:51.684052Z"
-    }
-   },
+   "execution_count": 6,
+   "metadata": {},
    "outputs": [],
    "source": [
     "compute_dtype = getattr(torch, \"float16\")\n",
@@ -233,28 +121,9 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 11,
-   "metadata": {
-    "ExecuteTime": {
-     "end_time": "2024-03-21T22:56:53.192388Z",
-     "start_time": "2024-03-21T22:56:52.671207Z"
-    }
-   },
-   "outputs": [
-    {
-     "ename": "ImportError",
-     "evalue": "Using `low_cpu_mem_usage=True` or a `device_map` requires Accelerate: `pip install accelerate`",
-     "output_type": "error",
-     "traceback": [
-      "\u001B[0;31m---------------------------------------------------------------------------\u001B[0m",
-      "\u001B[0;31mImportError\u001B[0m                               Traceback (most recent call last)",
-      "Cell \u001B[0;32mIn[11], line 1\u001B[0m\n\u001B[0;32m----> 1\u001B[0m model \u001B[38;5;241m=\u001B[39m AutoModelForCausalLM\u001B[38;5;241m.\u001B[39mfrom_pretrained(\n\u001B[1;32m      2\u001B[0m     base_model,\n\u001B[1;32m      3\u001B[0m     quantization_config\u001B[38;5;241m=\u001B[39mquant_config,\n\u001B[1;32m      4\u001B[0m     device_map\u001B[38;5;241m=\u001B[39m{\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124m\"\u001B[39m: \u001B[38;5;241m0\u001B[39m}\n\u001B[1;32m      5\u001B[0m )\n\u001B[1;32m      6\u001B[0m model\u001B[38;5;241m.\u001B[39mconfig\u001B[38;5;241m.\u001B[39muse_cache \u001B[38;5;241m=\u001B[39m \u001B[38;5;28;01mFalse\u001B[39;00m\n\u001B[1;32m      7\u001B[0m model\u001B[38;5;241m.\u001B[39mconfig\u001B[38;5;241m.\u001B[39mpretraining_tp \u001B[38;5;241m=\u001B[39m \u001B[38;5;241m1\u001B[39m\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/transformers/models/auto/auto_factory.py:516\u001B[0m, in \u001B[0;36m_BaseAutoModelClass.from_pretrained\u001B[0;34m(cls, pretrained_model_name_or_path, *model_args, **kwargs)\u001B[0m\n\u001B[1;32m    514\u001B[0m \u001B[38;5;28;01melif\u001B[39;00m \u001B[38;5;28mtype\u001B[39m(config) \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mcls\u001B[39m\u001B[38;5;241m.\u001B[39m_model_mapping\u001B[38;5;241m.\u001B[39mkeys():\n\u001B[1;32m    515\u001B[0m     model_class \u001B[38;5;241m=\u001B[39m _get_model_class(config, \u001B[38;5;28mcls\u001B[39m\u001B[38;5;241m.\u001B[39m_model_mapping)\n\u001B[0;32m--> 516\u001B[0m     \u001B[38;5;28;01mreturn\u001B[39;00m model_class\u001B[38;5;241m.\u001B[39mfrom_pretrained(\n\u001B[1;32m    517\u001B[0m         pretrained_model_name_or_path, \u001B[38;5;241m*\u001B[39mmodel_args, config\u001B[38;5;241m=\u001B[39mconfig, \u001B[38;5;241m*\u001B[39m\u001B[38;5;241m*\u001B[39mhub_kwargs, \u001B[38;5;241m*\u001B[39m\u001B[38;5;241m*\u001B[39mkwargs\n\u001B[1;32m    518\u001B[0m     )\n\u001B[1;32m    519\u001B[0m \u001B[38;5;28;01mraise\u001B[39;00m \u001B[38;5;167;01mValueError\u001B[39;00m(\n\u001B[1;32m    520\u001B[0m     \u001B[38;5;124mf\u001B[39m\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mUnrecognized configuration class \u001B[39m\u001B[38;5;132;01m{\u001B[39;00mconfig\u001B[38;5;241m.\u001B[39m\u001B[38;5;18m__class__\u001B[39m\u001B[38;5;132;01m}\u001B[39;00m\u001B[38;5;124m for this kind of AutoModel: \u001B[39m\u001B[38;5;132;01m{\u001B[39;00m\u001B[38;5;28mcls\u001B[39m\u001B[38;5;241m.\u001B[39m\u001B[38;5;18m__name__\u001B[39m\u001B[38;5;132;01m}\u001B[39;00m\u001B[38;5;124m.\u001B[39m\u001B[38;5;130;01m\\n\u001B[39;00m\u001B[38;5;124m\"\u001B[39m\n\u001B[1;32m    521\u001B[0m     \u001B[38;5;124mf\u001B[39m\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mModel type should be one of \u001B[39m\u001B[38;5;132;01m{\u001B[39;00m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124m, \u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;241m.\u001B[39mjoin(c\u001B[38;5;241m.\u001B[39m\u001B[38;5;18m__name__\u001B[39m\u001B[38;5;250m \u001B[39m\u001B[38;5;28;01mfor\u001B[39;00m\u001B[38;5;250m \u001B[39mc\u001B[38;5;250m \u001B[39m\u001B[38;5;129;01min\u001B[39;00m\u001B[38;5;250m \u001B[39m\u001B[38;5;28mcls\u001B[39m\u001B[38;5;241m.\u001B[39m_model_mapping\u001B[38;5;241m.\u001B[39mkeys())\u001B[38;5;132;01m}\u001B[39;00m\u001B[38;5;124m.\u001B[39m\u001B[38;5;124m\"\u001B[39m\n\u001B[1;32m    522\u001B[0m )\n",
-      "File \u001B[0;32m~/anaconda3/lib/python3.11/site-packages/transformers/modeling_utils.py:2368\u001B[0m, in \u001B[0;36mPreTrainedModel.from_pretrained\u001B[0;34m(cls, pretrained_model_name_or_path, config, cache_dir, ignore_mismatched_sizes, force_download, local_files_only, token, revision, use_safetensors, *model_args, **kwargs)\u001B[0m\n\u001B[1;32m   2364\u001B[0m         \u001B[38;5;28;01mraise\u001B[39;00m \u001B[38;5;167;01mValueError\u001B[39;00m(\n\u001B[1;32m   2365\u001B[0m             \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mDeepSpeed Zero-3 is not compatible with `low_cpu_mem_usage=True` or with passing a `device_map`.\u001B[39m\u001B[38;5;124m\"\u001B[39m\n\u001B[1;32m   2366\u001B[0m         )\n\u001B[1;32m   2367\u001B[0m     \u001B[38;5;28;01melif\u001B[39;00m \u001B[38;5;129;01mnot\u001B[39;00m is_accelerate_available():\n\u001B[0;32m-> 2368\u001B[0m         \u001B[38;5;28;01mraise\u001B[39;00m \u001B[38;5;167;01mImportError\u001B[39;00m(\n\u001B[1;32m   2369\u001B[0m             \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mUsing `low_cpu_mem_usage=True` or a `device_map` requires Accelerate: `pip install accelerate`\u001B[39m\u001B[38;5;124m\"\u001B[39m\n\u001B[1;32m   2370\u001B[0m         )\n\u001B[1;32m   2372\u001B[0m quantization_method_from_args \u001B[38;5;241m=\u001B[39m \u001B[38;5;28;01mNone\u001B[39;00m\n\u001B[1;32m   2373\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m quantization_config \u001B[38;5;129;01mis\u001B[39;00m \u001B[38;5;129;01mnot\u001B[39;00m \u001B[38;5;28;01mNone\u001B[39;00m:\n",
-      "\u001B[0;31mImportError\u001B[0m: Using `low_cpu_mem_usage=True` or a `device_map` requires Accelerate: `pip install accelerate`"
-     ]
-    }
-   ],
+   "execution_count": 7,
+   "metadata": {},
+   "outputs": [],
    "source": [
     "model = AutoModelForCausalLM.from_pretrained(\n",
     "    base_model,\n",
@@ -267,7 +136,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 8,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -278,7 +147,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 9,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -293,21 +162,21 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 10,
    "metadata": {},
    "outputs": [],
    "source": [
     "training_params = TrainingArguments(\n",
-    "    output_dir=\"./results\",\n",
+    "    output_dir=\"./tiny-llama-code-feedback\",\n",
     "    num_train_epochs=1,\n",
-    "    per_device_train_batch_size=4,\n",
-    "    gradient_accumulation_steps=1,\n",
+    "    per_device_train_batch_size=1,\n",
+    "    gradient_accumulation_steps=4,\n",
     "    optim=\"paged_adamw_32bit\",\n",
     "    save_steps=25,\n",
     "    logging_steps=25,\n",
     "    learning_rate=2e-4,\n",
     "    weight_decay=0.001,\n",
-    "    fp16=False,\n",
+    "    fp16=True,\n",
     "    bf16=False,\n",
     "    max_grad_norm=0.3,\n",
     "    max_steps=-1,\n",
@@ -320,13 +189,25 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 11,
    "metadata": {},
-   "outputs": [],
+   "outputs": [
+    {
+     "name": "stderr",
+     "output_type": "stream",
+     "text": [
+      "/home/bgsmagnuson/Documents/code_py/LLM-Debug-Assistant/venv/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:246: UserWarning: You didn't pass a `max_seq_length` argument to the SFTTrainer, this will default to 1024\n",
+      "  warnings.warn(\n",
+      "/home/bgsmagnuson/Documents/code_py/LLM-Debug-Assistant/venv/lib/python3.10/site-packages/accelerate/accelerator.py:436: FutureWarning: Passing the following arguments to `Accelerator` is deprecated and will be removed in version 1.0 of Accelerate: dict_keys(['dispatch_batches', 'split_batches', 'even_batches', 'use_seedable_sampler']). Please pass an `accelerate.DataLoaderConfiguration` instead: \n",
+      "dataloader_config = DataLoaderConfiguration(dispatch_batches=None, split_batches=False, even_batches=True, use_seedable_sampler=True)\n",
+      "  warnings.warn(\n"
+     ]
+    }
+   ],
    "source": [
     "trainer = SFTTrainer(\n",
     "    model=model,\n",
-    "    train_dataset=dataset,\n",
+    "    train_dataset=trunc_dataset,\n",
     "    peft_config=peft_params,\n",
     "    dataset_text_field=\"text\",\n",
     "    max_seq_length=None,\n",
@@ -338,12 +219,583 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 12,
    "metadata": {},
-   "outputs": [],
+   "outputs": [
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "ec7cf5abdddb42d78c847d106d2b0a4a",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "  0%|          | 0/10000 [00:00<?, ?it/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "name": "stdout",
+     "output_type": "stream",
+     "text": [
+      "{'loss': 1.1039, 'grad_norm': 0.1473865509033203, 'learning_rate': 0.0002, 'epoch': 0.0}\n",
+      "{'loss': 1.1087, 'grad_norm': nan, 'learning_rate': 0.0002, 'epoch': 0.01}\n",
+      "{'loss': 1.1259, 'grad_norm': 0.20463761687278748, 'learning_rate': 0.0002, 'epoch': 0.01}\n",
+      "{'loss': 1.08, 'grad_norm': 2.0228610038757324, 'learning_rate': 0.0002, 'epoch': 0.01}\n",
+      "{'loss': 1.0137, 'grad_norm': 0.2088489979505539, 'learning_rate': 0.0002, 'epoch': 0.01}\n",
+      "{'loss': 1.0303, 'grad_norm': 1.0524128675460815, 'learning_rate': 0.0002, 'epoch': 0.01}\n",
+      "{'loss': 1.0345, 'grad_norm': 0.16082286834716797, 'learning_rate': 0.0002, 'epoch': 0.02}\n",
+      "{'loss': 1.0448, 'grad_norm': 0.7031107544898987, 'learning_rate': 0.0002, 'epoch': 0.02}\n",
+      "{'loss': 0.9979, 'grad_norm': 0.19572685658931732, 'learning_rate': 0.0002, 'epoch': 0.02}\n",
+      "{'loss': 1.0275, 'grad_norm': 0.9878652691841125, 'learning_rate': 0.0002, 'epoch': 0.03}\n",
+      "{'loss': 0.9301, 'grad_norm': 0.16263549029827118, 'learning_rate': 0.0002, 'epoch': 0.03}\n",
+      "{'loss': 1.1053, 'grad_norm': 0.8138638734817505, 'learning_rate': 0.0002, 'epoch': 0.03}\n",
+      "{'loss': 1.0769, 'grad_norm': 0.1824832409620285, 'learning_rate': 0.0002, 'epoch': 0.03}\n",
+      "{'loss': 0.9711, 'grad_norm': 0.9486844539642334, 'learning_rate': 0.0002, 'epoch': 0.04}\n",
+      "{'loss': 0.9696, 'grad_norm': 0.16212576627731323, 'learning_rate': 0.0002, 'epoch': 0.04}\n",
+      "{'loss': 1.0512, 'grad_norm': 0.5512800216674805, 'learning_rate': 0.0002, 'epoch': 0.04}\n",
+      "{'loss': 0.9612, 'grad_norm': 0.1564604789018631, 'learning_rate': 0.0002, 'epoch': 0.04}\n",
+      "{'loss': 1.0159, 'grad_norm': 0.7925065159797668, 'learning_rate': 0.0002, 'epoch': 0.04}\n",
+      "{'loss': 0.8438, 'grad_norm': 0.15939272940158844, 'learning_rate': 0.0002, 'epoch': 0.05}\n",
+      "{'loss': 0.9968, 'grad_norm': 1.2181346416473389, 'learning_rate': 0.0002, 'epoch': 0.05}\n",
+      "{'loss': 1.0606, 'grad_norm': 0.18901243805885315, 'learning_rate': 0.0002, 'epoch': 0.05}\n",
+      "{'loss': 0.957, 'grad_norm': 1.0167464017868042, 'learning_rate': 0.0002, 'epoch': 0.06}\n",
+      "{'loss': 0.9509, 'grad_norm': 0.16407564282417297, 'learning_rate': 0.0002, 'epoch': 0.06}\n",
+      "{'loss': 0.9068, 'grad_norm': 0.7964873313903809, 'learning_rate': 0.0002, 'epoch': 0.06}\n",
+      "{'loss': 0.9692, 'grad_norm': 0.1474466323852539, 'learning_rate': 0.0002, 'epoch': 0.06}\n",
+      "{'loss': 0.8666, 'grad_norm': 0.5529358983039856, 'learning_rate': 0.0002, 'epoch': 0.07}\n",
+      "{'loss': 0.9897, 'grad_norm': 0.17560884356498718, 'learning_rate': 0.0002, 'epoch': 0.07}\n",
+      "{'loss': 0.9755, 'grad_norm': 0.744655430316925, 'learning_rate': 0.0002, 'epoch': 0.07}\n",
+      "{'loss': 0.9929, 'grad_norm': 0.13952620327472687, 'learning_rate': 0.0002, 'epoch': 0.07}\n",
+      "{'loss': 0.9002, 'grad_norm': 0.5299781560897827, 'learning_rate': 0.0002, 'epoch': 0.07}\n",
+      "{'loss': 0.9395, 'grad_norm': 0.15891987085342407, 'learning_rate': 0.0002, 'epoch': 0.08}\n",
+      "{'loss': 0.9509, 'grad_norm': 0.46100297570228577, 'learning_rate': 0.0002, 'epoch': 0.08}\n",
+      "{'loss': 0.9772, 'grad_norm': 0.16506388783454895, 'learning_rate': 0.0002, 'epoch': 0.08}\n",
+      "{'loss': 0.9402, 'grad_norm': 0.6863508820533752, 'learning_rate': 0.0002, 'epoch': 0.09}\n",
+      "{'loss': 0.8811, 'grad_norm': 0.18882785737514496, 'learning_rate': 0.0002, 'epoch': 0.09}\n",
+      "{'loss': 0.9429, 'grad_norm': 0.6042115688323975, 'learning_rate': 0.0002, 'epoch': 0.09}\n",
+      "{'loss': 1.028, 'grad_norm': 0.1462540477514267, 'learning_rate': 0.0002, 'epoch': 0.09}\n",
+      "{'loss': 0.9468, 'grad_norm': 0.8108144998550415, 'learning_rate': 0.0002, 'epoch': 0.1}\n",
+      "{'loss': 0.9969, 'grad_norm': 0.17016586661338806, 'learning_rate': 0.0002, 'epoch': 0.1}\n",
+      "{'loss': 0.9752, 'grad_norm': 1.0114277601242065, 'learning_rate': 0.0002, 'epoch': 0.1}\n",
+      "{'loss': 1.0004, 'grad_norm': 0.17824725806713104, 'learning_rate': 0.0002, 'epoch': 0.1}\n",
+      "{'loss': 1.0048, 'grad_norm': 0.5518081784248352, 'learning_rate': 0.0002, 'epoch': 0.1}\n",
+      "{'loss': 1.0757, 'grad_norm': 0.1807875782251358, 'learning_rate': 0.0002, 'epoch': 0.11}\n",
+      "{'loss': 0.9586, 'grad_norm': 0.6609805822372437, 'learning_rate': 0.0002, 'epoch': 0.11}\n",
+      "{'loss': 0.901, 'grad_norm': 0.14438281953334808, 'learning_rate': 0.0002, 'epoch': 0.11}\n",
+      "{'loss': 0.9674, 'grad_norm': 0.5785639882087708, 'learning_rate': 0.0002, 'epoch': 0.12}\n",
+      "{'loss': 1.0211, 'grad_norm': 0.1708645522594452, 'learning_rate': 0.0002, 'epoch': 0.12}\n",
+      "{'loss': 0.9613, 'grad_norm': 0.6358480453491211, 'learning_rate': 0.0002, 'epoch': 0.12}\n",
+      "{'loss': 0.9996, 'grad_norm': 0.14341296255588531, 'learning_rate': 0.0002, 'epoch': 0.12}\n",
+      "{'loss': 0.9574, 'grad_norm': 0.7054002285003662, 'learning_rate': 0.0002, 'epoch': 0.12}\n",
+      "{'loss': 0.9402, 'grad_norm': 0.19284452497959137, 'learning_rate': 0.0002, 'epoch': 0.13}\n",
+      "{'loss': 0.9702, 'grad_norm': 0.6732187271118164, 'learning_rate': 0.0002, 'epoch': 0.13}\n",
+      "{'loss': 0.9383, 'grad_norm': 0.16392892599105835, 'learning_rate': 0.0002, 'epoch': 0.13}\n",
+      "{'loss': 0.8871, 'grad_norm': 0.546034574508667, 'learning_rate': 0.0002, 'epoch': 0.14}\n",
+      "{'loss': 1.0381, 'grad_norm': 0.19721634685993195, 'learning_rate': 0.0002, 'epoch': 0.14}\n",
+      "{'loss': 0.8946, 'grad_norm': 0.4309283494949341, 'learning_rate': 0.0002, 'epoch': 0.14}\n",
+      "{'loss': 0.9881, 'grad_norm': 0.17368640005588531, 'learning_rate': 0.0002, 'epoch': 0.14}\n",
+      "{'loss': 1.014, 'grad_norm': 0.8383578658103943, 'learning_rate': 0.0002, 'epoch': 0.14}\n",
+      "{'loss': 1.0157, 'grad_norm': 0.17120376229286194, 'learning_rate': 0.0002, 'epoch': 0.15}\n",
+      "{'loss': 0.9568, 'grad_norm': 0.8268991112709045, 'learning_rate': 0.0002, 'epoch': 0.15}\n",
+      "{'loss': 0.9533, 'grad_norm': 0.17330726981163025, 'learning_rate': 0.0002, 'epoch': 0.15}\n",
+      "{'loss': 0.92, 'grad_norm': 0.6172852516174316, 'learning_rate': 0.0002, 'epoch': 0.15}\n",
+      "{'loss': 0.9033, 'grad_norm': 0.17465423047542572, 'learning_rate': 0.0002, 'epoch': 0.16}\n",
+      "{'loss': 0.9121, 'grad_norm': 0.5994295477867126, 'learning_rate': 0.0002, 'epoch': 0.16}\n",
+      "{'loss': 1.0021, 'grad_norm': 0.16907010972499847, 'learning_rate': 0.0002, 'epoch': 0.16}\n",
+      "{'loss': 0.9639, 'grad_norm': 0.4903848469257355, 'learning_rate': 0.0002, 'epoch': 0.17}\n",
+      "{'loss': 0.9027, 'grad_norm': 0.1403561532497406, 'learning_rate': 0.0002, 'epoch': 0.17}\n",
+      "{'loss': 0.9313, 'grad_norm': 0.8235511779785156, 'learning_rate': 0.0002, 'epoch': 0.17}\n",
+      "{'loss': 1.0055, 'grad_norm': 0.18666565418243408, 'learning_rate': 0.0002, 'epoch': 0.17}\n",
+      "{'loss': 0.9546, 'grad_norm': 0.5993369221687317, 'learning_rate': 0.0002, 'epoch': 0.17}\n",
+      "{'loss': 1.0227, 'grad_norm': 0.15853627026081085, 'learning_rate': 0.0002, 'epoch': 0.18}\n",
+      "{'loss': 0.9461, 'grad_norm': 0.7348814606666565, 'learning_rate': 0.0002, 'epoch': 0.18}\n",
+      "{'loss': 0.982, 'grad_norm': 0.15170517563819885, 'learning_rate': 0.0002, 'epoch': 0.18}\n",
+      "{'loss': 1.0149, 'grad_norm': 0.6949355006217957, 'learning_rate': 0.0002, 'epoch': 0.18}\n",
+      "{'loss': 0.9671, 'grad_norm': 0.1654372215270996, 'learning_rate': 0.0002, 'epoch': 0.19}\n",
+      "{'loss': 0.9034, 'grad_norm': 1.227147102355957, 'learning_rate': 0.0002, 'epoch': 0.19}\n",
+      "{'loss': 1.0138, 'grad_norm': 0.17835673689842224, 'learning_rate': 0.0002, 'epoch': 0.19}\n",
+      "{'loss': 0.9031, 'grad_norm': 0.5519052743911743, 'learning_rate': 0.0002, 'epoch': 0.2}\n",
+      "{'loss': 0.9872, 'grad_norm': 0.15722355246543884, 'learning_rate': 0.0002, 'epoch': 0.2}\n",
+      "{'loss': 0.9728, 'grad_norm': 0.7770719528198242, 'learning_rate': 0.0002, 'epoch': 0.2}\n",
+      "{'loss': 0.9731, 'grad_norm': 0.1761191040277481, 'learning_rate': 0.0002, 'epoch': 0.2}\n",
+      "{'loss': 0.8952, 'grad_norm': 0.714655876159668, 'learning_rate': 0.0002, 'epoch': 0.2}\n",
+      "{'loss': 0.9407, 'grad_norm': 0.14995768666267395, 'learning_rate': 0.0002, 'epoch': 0.21}\n",
+      "{'loss': 0.9546, 'grad_norm': 0.7260432243347168, 'learning_rate': 0.0002, 'epoch': 0.21}\n",
+      "{'loss': 0.9653, 'grad_norm': 0.15550945699214935, 'learning_rate': 0.0002, 'epoch': 0.21}\n",
+      "{'loss': 0.9441, 'grad_norm': nan, 'learning_rate': 0.0002, 'epoch': 0.21}\n",
+      "{'loss': 0.9899, 'grad_norm': 0.19342724978923798, 'learning_rate': 0.0002, 'epoch': 0.22}\n",
+      "{'loss': 0.8665, 'grad_norm': 0.5888460278511047, 'learning_rate': 0.0002, 'epoch': 0.22}\n",
+      "{'loss': 0.9416, 'grad_norm': 0.16942153871059418, 'learning_rate': 0.0002, 'epoch': 0.22}\n",
+      "{'loss': 0.9211, 'grad_norm': nan, 'learning_rate': 0.0002, 'epoch': 0.23}\n",
+      "{'loss': 0.9709, 'grad_norm': 0.14640675485134125, 'learning_rate': 0.0002, 'epoch': 0.23}\n",
+      "{'loss': 0.8991, 'grad_norm': 0.6530085206031799, 'learning_rate': 0.0002, 'epoch': 0.23}\n",
+      "{'loss': 0.9113, 'grad_norm': 0.15613000094890594, 'learning_rate': 0.0002, 'epoch': 0.23}\n",
+      "{'loss': 0.9628, 'grad_norm': 0.48987045884132385, 'learning_rate': 0.0002, 'epoch': 0.23}\n",
+      "{'loss': 0.9861, 'grad_norm': 0.20149683952331543, 'learning_rate': 0.0002, 'epoch': 0.24}\n",
+      "{'loss': 0.9742, 'grad_norm': 0.5727905035018921, 'learning_rate': 0.0002, 'epoch': 0.24}\n",
+      "{'loss': 0.8676, 'grad_norm': 0.1859622448682785, 'learning_rate': 0.0002, 'epoch': 0.24}\n",
+      "{'loss': 0.8748, 'grad_norm': 0.5710355043411255, 'learning_rate': 0.0002, 'epoch': 0.24}\n",
+      "{'loss': 1.0037, 'grad_norm': 0.14951194822788239, 'learning_rate': 0.0002, 'epoch': 0.25}\n",
+      "{'loss': 0.9046, 'grad_norm': 0.6935268640518188, 'learning_rate': 0.0002, 'epoch': 0.25}\n",
+      "{'loss': 0.946, 'grad_norm': 0.18522819876670837, 'learning_rate': 0.0002, 'epoch': 0.25}\n",
+      "{'loss': 0.9371, 'grad_norm': 0.9770438075065613, 'learning_rate': 0.0002, 'epoch': 0.26}\n",
+      "{'loss': 0.9257, 'grad_norm': 0.18332898616790771, 'learning_rate': 0.0002, 'epoch': 0.26}\n",
+      "{'loss': 0.9311, 'grad_norm': 1.0680220127105713, 'learning_rate': 0.0002, 'epoch': 0.26}\n",
+      "{'loss': 0.93, 'grad_norm': 0.16681881248950958, 'learning_rate': 0.0002, 'epoch': 0.26}\n",
+      "{'loss': 0.8941, 'grad_norm': 0.46773549914360046, 'learning_rate': 0.0002, 'epoch': 0.27}\n",
+      "{'loss': 0.9175, 'grad_norm': 0.16685403883457184, 'learning_rate': 0.0002, 'epoch': 0.27}\n",
+      "{'loss': 0.9741, 'grad_norm': 0.704140305519104, 'learning_rate': 0.0002, 'epoch': 0.27}\n",
+      "{'loss': 0.9475, 'grad_norm': 0.15739645063877106, 'learning_rate': 0.0002, 'epoch': 0.27}\n",
+      "{'loss': 0.9365, 'grad_norm': 0.5654866099357605, 'learning_rate': 0.0002, 'epoch': 0.28}\n",
+      "{'loss': 0.9988, 'grad_norm': 0.1954333782196045, 'learning_rate': 0.0002, 'epoch': 0.28}\n",
+      "{'loss': 0.9067, 'grad_norm': 0.5965314507484436, 'learning_rate': 0.0002, 'epoch': 0.28}\n",
+      "{'loss': 0.9217, 'grad_norm': 0.19402556121349335, 'learning_rate': 0.0002, 'epoch': 0.28}\n",
+      "{'loss': 0.8886, 'grad_norm': 1.1799172163009644, 'learning_rate': 0.0002, 'epoch': 0.28}\n",
+      "{'loss': 0.9948, 'grad_norm': 0.1434619426727295, 'learning_rate': 0.0002, 'epoch': 0.29}\n",
+      "{'loss': 0.9438, 'grad_norm': 0.5917403101921082, 'learning_rate': 0.0002, 'epoch': 0.29}\n",
+      "{'loss': 0.9731, 'grad_norm': 0.16124939918518066, 'learning_rate': 0.0002, 'epoch': 0.29}\n",
+      "{'loss': 0.9767, 'grad_norm': 0.590294599533081, 'learning_rate': 0.0002, 'epoch': 0.29}\n",
+      "{'loss': 0.9204, 'grad_norm': 0.15503399074077606, 'learning_rate': 0.0002, 'epoch': 0.3}\n",
+      "{'loss': 0.9404, 'grad_norm': 0.8178427815437317, 'learning_rate': 0.0002, 'epoch': 0.3}\n",
+      "{'loss': 0.9458, 'grad_norm': 0.17826278507709503, 'learning_rate': 0.0002, 'epoch': 0.3}\n",
+      "{'loss': 0.9281, 'grad_norm': 0.45490437746047974, 'learning_rate': 0.0002, 'epoch': 0.3}\n",
+      "{'loss': 0.9365, 'grad_norm': 0.1904248148202896, 'learning_rate': 0.0002, 'epoch': 0.31}\n",
+      "{'loss': 0.9241, 'grad_norm': 0.5431923866271973, 'learning_rate': 0.0002, 'epoch': 0.31}\n",
+      "{'loss': 1.0098, 'grad_norm': 0.16843143105506897, 'learning_rate': 0.0002, 'epoch': 0.31}\n",
+      "{'loss': 0.9559, 'grad_norm': 0.6602270603179932, 'learning_rate': 0.0002, 'epoch': 0.32}\n",
+      "{'loss': 0.9458, 'grad_norm': 0.15411706268787384, 'learning_rate': 0.0002, 'epoch': 0.32}\n",
+      "{'loss': 0.9158, 'grad_norm': 0.9508289694786072, 'learning_rate': 0.0002, 'epoch': 0.32}\n",
+      "{'loss': 0.9445, 'grad_norm': 0.16246093809604645, 'learning_rate': 0.0002, 'epoch': 0.32}\n",
+      "{'loss': 0.9772, 'grad_norm': 0.809680700302124, 'learning_rate': 0.0002, 'epoch': 0.33}\n",
+      "{'loss': 0.9616, 'grad_norm': 0.1763370782136917, 'learning_rate': 0.0002, 'epoch': 0.33}\n",
+      "{'loss': 0.8943, 'grad_norm': 0.6156730651855469, 'learning_rate': 0.0002, 'epoch': 0.33}\n",
+      "{'loss': 0.9066, 'grad_norm': 0.20638826489448547, 'learning_rate': 0.0002, 'epoch': 0.33}\n",
+      "{'loss': 0.9081, 'grad_norm': 0.6561472415924072, 'learning_rate': 0.0002, 'epoch': 0.34}\n",
+      "{'loss': 0.9211, 'grad_norm': 0.18327024579048157, 'learning_rate': 0.0002, 'epoch': 0.34}\n",
+      "{'loss': 0.8897, 'grad_norm': 0.9138961434364319, 'learning_rate': 0.0002, 'epoch': 0.34}\n",
+      "{'loss': 1.0096, 'grad_norm': 0.15767188370227814, 'learning_rate': 0.0002, 'epoch': 0.34}\n",
+      "{'loss': 0.8837, 'grad_norm': 0.5125522613525391, 'learning_rate': 0.0002, 'epoch': 0.34}\n",
+      "{'loss': 0.9325, 'grad_norm': 0.16168996691703796, 'learning_rate': 0.0002, 'epoch': 0.35}\n",
+      "{'loss': 0.9753, 'grad_norm': 0.9087097644805908, 'learning_rate': 0.0002, 'epoch': 0.35}\n",
+      "{'loss': 0.9119, 'grad_norm': 0.15069128572940826, 'learning_rate': 0.0002, 'epoch': 0.35}\n",
+      "{'loss': 0.8857, 'grad_norm': 0.5145788788795471, 'learning_rate': 0.0002, 'epoch': 0.35}\n",
+      "{'loss': 0.9383, 'grad_norm': 0.19048061966896057, 'learning_rate': 0.0002, 'epoch': 0.36}\n",
+      "{'loss': 0.9258, 'grad_norm': 0.5361146330833435, 'learning_rate': 0.0002, 'epoch': 0.36}\n",
+      "{'loss': 0.9488, 'grad_norm': 0.14951658248901367, 'learning_rate': 0.0002, 'epoch': 0.36}\n",
+      "{'loss': 0.8776, 'grad_norm': 0.6128055453300476, 'learning_rate': 0.0002, 'epoch': 0.36}\n",
+      "{'loss': 0.9088, 'grad_norm': 0.18097293376922607, 'learning_rate': 0.0002, 'epoch': 0.37}\n",
+      "{'loss': 0.9073, 'grad_norm': 0.6186358332633972, 'learning_rate': 0.0002, 'epoch': 0.37}\n",
+      "{'loss': 0.9003, 'grad_norm': 0.19043993949890137, 'learning_rate': 0.0002, 'epoch': 0.37}\n",
+      "{'loss': 0.9086, 'grad_norm': 0.9779380559921265, 'learning_rate': 0.0002, 'epoch': 0.38}\n",
+      "{'loss': 0.899, 'grad_norm': 0.19679412245750427, 'learning_rate': 0.0002, 'epoch': 0.38}\n",
+      "{'loss': 0.911, 'grad_norm': 0.695183277130127, 'learning_rate': 0.0002, 'epoch': 0.38}\n",
+      "{'loss': 0.9871, 'grad_norm': 0.19006764888763428, 'learning_rate': 0.0002, 'epoch': 0.38}\n",
+      "{'loss': 0.9681, 'grad_norm': 0.5479898452758789, 'learning_rate': 0.0002, 'epoch': 0.39}\n",
+      "{'loss': 0.9422, 'grad_norm': 0.17096063494682312, 'learning_rate': 0.0002, 'epoch': 0.39}\n",
+      "{'loss': 0.9219, 'grad_norm': 0.5813881158828735, 'learning_rate': 0.0002, 'epoch': 0.39}\n",
+      "{'loss': 0.9477, 'grad_norm': 0.1810421496629715, 'learning_rate': 0.0002, 'epoch': 0.39}\n",
+      "{'loss': 0.9911, 'grad_norm': 0.9231253266334534, 'learning_rate': 0.0002, 'epoch': 0.4}\n",
+      "{'loss': 1.086, 'grad_norm': 0.15716998279094696, 'learning_rate': 0.0002, 'epoch': 0.4}\n",
+      "{'loss': 0.9175, 'grad_norm': 0.8333872556686401, 'learning_rate': 0.0002, 'epoch': 0.4}\n",
+      "{'loss': 0.8802, 'grad_norm': 0.15496739745140076, 'learning_rate': 0.0002, 'epoch': 0.4}\n",
+      "{'loss': 0.8937, 'grad_norm': 0.5601121187210083, 'learning_rate': 0.0002, 'epoch': 0.41}\n",
+      "{'loss': 1.0018, 'grad_norm': 0.15465256571769714, 'learning_rate': 0.0002, 'epoch': 0.41}\n",
+      "{'loss': 0.9231, 'grad_norm': 0.5901041626930237, 'learning_rate': 0.0002, 'epoch': 0.41}\n",
+      "{'loss': 0.9212, 'grad_norm': 0.16790370643138885, 'learning_rate': 0.0002, 'epoch': 0.41}\n",
+      "{'loss': 0.9873, 'grad_norm': 0.9871569275856018, 'learning_rate': 0.0002, 'epoch': 0.41}\n",
+      "{'loss': 0.899, 'grad_norm': 0.1784098893404007, 'learning_rate': 0.0002, 'epoch': 0.42}\n",
+      "{'loss': 0.8913, 'grad_norm': 1.080674171447754, 'learning_rate': 0.0002, 'epoch': 0.42}\n",
+      "{'loss': 0.9333, 'grad_norm': 0.18134307861328125, 'learning_rate': 0.0002, 'epoch': 0.42}\n",
+      "{'loss': 0.8932, 'grad_norm': 0.7931810021400452, 'learning_rate': 0.0002, 'epoch': 0.42}\n",
+      "{'loss': 1.0177, 'grad_norm': 0.17424467206001282, 'learning_rate': 0.0002, 'epoch': 0.43}\n",
+      "{'loss': 0.9322, 'grad_norm': 0.7647857069969177, 'learning_rate': 0.0002, 'epoch': 0.43}\n",
+      "{'loss': 1.0242, 'grad_norm': 0.17789813876152039, 'learning_rate': 0.0002, 'epoch': 0.43}\n",
+      "{'loss': 0.8537, 'grad_norm': 0.9046485424041748, 'learning_rate': 0.0002, 'epoch': 0.43}\n",
+      "{'loss': 0.911, 'grad_norm': 0.17194864153862, 'learning_rate': 0.0002, 'epoch': 0.44}\n",
+      "{'loss': 0.9081, 'grad_norm': 0.5690350532531738, 'learning_rate': 0.0002, 'epoch': 0.44}\n",
+      "{'loss': 1.0072, 'grad_norm': 0.16935771703720093, 'learning_rate': 0.0002, 'epoch': 0.44}\n",
+      "{'loss': 0.9342, 'grad_norm': 0.4512929618358612, 'learning_rate': 0.0002, 'epoch': 0.45}\n",
+      "{'loss': 0.8486, 'grad_norm': 0.17375916242599487, 'learning_rate': 0.0002, 'epoch': 0.45}\n",
+      "{'loss': 0.9179, 'grad_norm': 0.7382855415344238, 'learning_rate': 0.0002, 'epoch': 0.45}\n",
+      "{'loss': 0.8992, 'grad_norm': 0.16021981835365295, 'learning_rate': 0.0002, 'epoch': 0.45}\n",
+      "{'loss': 1.0266, 'grad_norm': 1.1508495807647705, 'learning_rate': 0.0002, 'epoch': 0.46}\n",
+      "{'loss': 0.9024, 'grad_norm': 0.19768942892551422, 'learning_rate': 0.0002, 'epoch': 0.46}\n",
+      "{'loss': 0.887, 'grad_norm': 0.45622074604034424, 'learning_rate': 0.0002, 'epoch': 0.46}\n",
+      "{'loss': 1.0011, 'grad_norm': 0.18411509692668915, 'learning_rate': 0.0002, 'epoch': 0.46}\n",
+      "{'loss': 0.9291, 'grad_norm': 0.7298449277877808, 'learning_rate': 0.0002, 'epoch': 0.47}\n",
+      "{'loss': 0.8471, 'grad_norm': 0.17489437758922577, 'learning_rate': 0.0002, 'epoch': 0.47}\n",
+      "{'loss': 0.8976, 'grad_norm': 0.6527608633041382, 'learning_rate': 0.0002, 'epoch': 0.47}\n",
+      "{'loss': 0.9488, 'grad_norm': 0.17943738400936127, 'learning_rate': 0.0002, 'epoch': 0.47}\n",
+      "{'loss': 0.8953, 'grad_norm': 0.43084022402763367, 'learning_rate': 0.0002, 'epoch': 0.47}\n",
+      "{'loss': 0.9554, 'grad_norm': 0.15030547976493835, 'learning_rate': 0.0002, 'epoch': 0.48}\n",
+      "{'loss': 0.9391, 'grad_norm': 0.6574497818946838, 'learning_rate': 0.0002, 'epoch': 0.48}\n",
+      "{'loss': 0.9359, 'grad_norm': 0.1792439967393875, 'learning_rate': 0.0002, 'epoch': 0.48}\n",
+      "{'loss': 0.9541, 'grad_norm': 1.103253722190857, 'learning_rate': 0.0002, 'epoch': 0.48}\n",
+      "{'loss': 0.9726, 'grad_norm': 0.1727408468723297, 'learning_rate': 0.0002, 'epoch': 0.49}\n",
+      "{'loss': 0.9093, 'grad_norm': 0.5923681259155273, 'learning_rate': 0.0002, 'epoch': 0.49}\n",
+      "{'loss': 0.9404, 'grad_norm': 0.1725590080022812, 'learning_rate': 0.0002, 'epoch': 0.49}\n",
+      "{'loss': 0.8707, 'grad_norm': 0.649212658405304, 'learning_rate': 0.0002, 'epoch': 0.49}\n",
+      "{'loss': 0.8741, 'grad_norm': 0.16458356380462646, 'learning_rate': 0.0002, 'epoch': 0.5}\n",
+      "{'loss': 0.8799, 'grad_norm': 0.49708107113838196, 'learning_rate': 0.0002, 'epoch': 0.5}\n",
+      "{'loss': 0.9108, 'grad_norm': 0.24258512258529663, 'learning_rate': 0.0002, 'epoch': 0.5}\n",
+      "{'loss': 0.9263, 'grad_norm': 0.886997401714325, 'learning_rate': 0.0002, 'epoch': 0.51}\n",
+      "{'loss': 0.8988, 'grad_norm': 0.17355671525001526, 'learning_rate': 0.0002, 'epoch': 0.51}\n",
+      "{'loss': 0.9497, 'grad_norm': 0.5229758024215698, 'learning_rate': 0.0002, 'epoch': 0.51}\n",
+      "{'loss': 0.9066, 'grad_norm': 0.1711326539516449, 'learning_rate': 0.0002, 'epoch': 0.51}\n",
+      "{'loss': 0.938, 'grad_norm': 0.5563514232635498, 'learning_rate': 0.0002, 'epoch': 0.52}\n",
+      "{'loss': 0.9854, 'grad_norm': 0.17421077191829681, 'learning_rate': 0.0002, 'epoch': 0.52}\n",
+      "{'loss': 0.8528, 'grad_norm': 0.5765153765678406, 'learning_rate': 0.0002, 'epoch': 0.52}\n",
+      "{'loss': 0.9101, 'grad_norm': 0.1576261818408966, 'learning_rate': 0.0002, 'epoch': 0.52}\n",
+      "{'loss': 0.9565, 'grad_norm': 0.7621123194694519, 'learning_rate': 0.0002, 'epoch': 0.53}\n",
+      "{'loss': 0.8985, 'grad_norm': 0.16743089258670807, 'learning_rate': 0.0002, 'epoch': 0.53}\n",
+      "{'loss': 0.8453, 'grad_norm': 0.524124264717102, 'learning_rate': 0.0002, 'epoch': 0.53}\n",
+      "{'loss': 0.9632, 'grad_norm': 0.21563546359539032, 'learning_rate': 0.0002, 'epoch': 0.53}\n",
+      "{'loss': 0.9212, 'grad_norm': 0.5831035375595093, 'learning_rate': 0.0002, 'epoch': 0.54}\n",
+      "{'loss': 0.8734, 'grad_norm': 0.17566201090812683, 'learning_rate': 0.0002, 'epoch': 0.54}\n",
+      "{'loss': 0.9401, 'grad_norm': 0.6591996550559998, 'learning_rate': 0.0002, 'epoch': 0.54}\n",
+      "{'loss': 0.9407, 'grad_norm': 0.20948630571365356, 'learning_rate': 0.0002, 'epoch': 0.54}\n",
+      "{'loss': 0.9071, 'grad_norm': 0.5042433738708496, 'learning_rate': 0.0002, 'epoch': 0.55}\n",
+      "{'loss': 0.8821, 'grad_norm': 0.18091623485088348, 'learning_rate': 0.0002, 'epoch': 0.55}\n",
+      "{'loss': 0.9548, 'grad_norm': 0.7484546303749084, 'learning_rate': 0.0002, 'epoch': 0.55}\n",
+      "{'loss': 0.8251, 'grad_norm': 0.17899231612682343, 'learning_rate': 0.0002, 'epoch': 0.55}\n",
+      "{'loss': 0.9432, 'grad_norm': 0.8085604310035706, 'learning_rate': 0.0002, 'epoch': 0.56}\n",
+      "{'loss': 0.9271, 'grad_norm': 0.18541403114795685, 'learning_rate': 0.0002, 'epoch': 0.56}\n",
+      "{'loss': 0.9402, 'grad_norm': 0.6206398010253906, 'learning_rate': 0.0002, 'epoch': 0.56}\n",
+      "{'loss': 0.9215, 'grad_norm': 0.19536328315734863, 'learning_rate': 0.0002, 'epoch': 0.56}\n",
+      "{'loss': 0.8833, 'grad_norm': 0.4756429195404053, 'learning_rate': 0.0002, 'epoch': 0.56}\n",
+      "{'loss': 1.0037, 'grad_norm': 0.1595390886068344, 'learning_rate': 0.0002, 'epoch': 0.57}\n",
+      "{'loss': 0.855, 'grad_norm': 0.8130165934562683, 'learning_rate': 0.0002, 'epoch': 0.57}\n",
+      "{'loss': 0.863, 'grad_norm': 0.16568921506404877, 'learning_rate': 0.0002, 'epoch': 0.57}\n",
+      "{'loss': 0.943, 'grad_norm': 0.7665693163871765, 'learning_rate': 0.0002, 'epoch': 0.57}\n",
+      "{'loss': 0.9718, 'grad_norm': 0.1815584897994995, 'learning_rate': 0.0002, 'epoch': 0.58}\n",
+      "{'loss': 0.8853, 'grad_norm': 0.5483242273330688, 'learning_rate': 0.0002, 'epoch': 0.58}\n",
+      "{'loss': 0.967, 'grad_norm': 0.18747632205486298, 'learning_rate': 0.0002, 'epoch': 0.58}\n",
+      "{'loss': 0.9105, 'grad_norm': 0.6053564548492432, 'learning_rate': 0.0002, 'epoch': 0.58}\n",
+      "{'loss': 0.9865, 'grad_norm': 0.17128074169158936, 'learning_rate': 0.0002, 'epoch': 0.59}\n",
+      "{'loss': 0.8298, 'grad_norm': 0.3980049788951874, 'learning_rate': 0.0002, 'epoch': 0.59}\n",
+      "{'loss': 0.9519, 'grad_norm': 0.18285776674747467, 'learning_rate': 0.0002, 'epoch': 0.59}\n",
+      "{'loss': 0.9544, 'grad_norm': 1.1445808410644531, 'learning_rate': 0.0002, 'epoch': 0.59}\n",
+      "{'loss': 0.9433, 'grad_norm': 0.16244882345199585, 'learning_rate': 0.0002, 'epoch': 0.6}\n",
+      "{'loss': 0.9326, 'grad_norm': 0.7913817167282104, 'learning_rate': 0.0002, 'epoch': 0.6}\n",
+      "{'loss': 0.8912, 'grad_norm': 0.16521696746349335, 'learning_rate': 0.0002, 'epoch': 0.6}\n",
+      "{'loss': 0.8929, 'grad_norm': 0.5225160121917725, 'learning_rate': 0.0002, 'epoch': 0.6}\n",
+      "{'loss': 0.9395, 'grad_norm': 0.16945147514343262, 'learning_rate': 0.0002, 'epoch': 0.61}\n",
+      "{'loss': 0.9179, 'grad_norm': 0.5072753429412842, 'learning_rate': 0.0002, 'epoch': 0.61}\n",
+      "{'loss': 0.9321, 'grad_norm': 0.18221701681613922, 'learning_rate': 0.0002, 'epoch': 0.61}\n",
+      "{'loss': 0.8637, 'grad_norm': 0.5503445267677307, 'learning_rate': 0.0002, 'epoch': 0.61}\n",
+      "{'loss': 0.9104, 'grad_norm': 0.16132435202598572, 'learning_rate': 0.0002, 'epoch': 0.62}\n",
+      "{'loss': 0.9398, 'grad_norm': 0.7780868411064148, 'learning_rate': 0.0002, 'epoch': 0.62}\n",
+      "{'loss': 0.9328, 'grad_norm': 0.16113488376140594, 'learning_rate': 0.0002, 'epoch': 0.62}\n",
+      "{'loss': 0.8464, 'grad_norm': 0.5365278124809265, 'learning_rate': 0.0002, 'epoch': 0.62}\n",
+      "{'loss': 0.9461, 'grad_norm': 0.18457038700580597, 'learning_rate': 0.0002, 'epoch': 0.63}\n",
+      "{'loss': 0.8456, 'grad_norm': 0.48690107464790344, 'learning_rate': 0.0002, 'epoch': 0.63}\n",
+      "{'loss': 0.9649, 'grad_norm': 0.17006038129329681, 'learning_rate': 0.0002, 'epoch': 0.63}\n",
+      "{'loss': 0.8675, 'grad_norm': nan, 'learning_rate': 0.0002, 'epoch': 0.64}\n",
+      "{'loss': 1.0493, 'grad_norm': 0.17708832025527954, 'learning_rate': 0.0002, 'epoch': 0.64}\n",
+      "{'loss': 0.8737, 'grad_norm': 0.6289100646972656, 'learning_rate': 0.0002, 'epoch': 0.64}\n",
+      "{'loss': 0.9504, 'grad_norm': 0.17200163006782532, 'learning_rate': 0.0002, 'epoch': 0.64}\n",
+      "{'loss': 0.8862, 'grad_norm': 0.5949751734733582, 'learning_rate': 0.0002, 'epoch': 0.65}\n",
+      "{'loss': 0.9641, 'grad_norm': 0.17354971170425415, 'learning_rate': 0.0002, 'epoch': 0.65}\n",
+      "{'loss': 0.9326, 'grad_norm': 0.6846174001693726, 'learning_rate': 0.0002, 'epoch': 0.65}\n",
+      "{'loss': 0.8727, 'grad_norm': 0.17824096977710724, 'learning_rate': 0.0002, 'epoch': 0.65}\n",
+      "{'loss': 0.891, 'grad_norm': 0.5190985798835754, 'learning_rate': 0.0002, 'epoch': 0.66}\n",
+      "{'loss': 0.9804, 'grad_norm': 0.17645037174224854, 'learning_rate': 0.0002, 'epoch': 0.66}\n",
+      "{'loss': 0.8497, 'grad_norm': 0.5538886189460754, 'learning_rate': 0.0002, 'epoch': 0.66}\n",
+      "{'loss': 0.9576, 'grad_norm': 0.19610869884490967, 'learning_rate': 0.0002, 'epoch': 0.66}\n",
+      "{'loss': 0.8358, 'grad_norm': 0.44791531562805176, 'learning_rate': 0.0002, 'epoch': 0.67}\n",
+      "{'loss': 0.9703, 'grad_norm': 0.1554679125547409, 'learning_rate': 0.0002, 'epoch': 0.67}\n",
+      "{'loss': 0.9388, 'grad_norm': 0.6402133703231812, 'learning_rate': 0.0002, 'epoch': 0.67}\n",
+      "{'loss': 1.0377, 'grad_norm': 0.20206980407238007, 'learning_rate': 0.0002, 'epoch': 0.67}\n",
+      "{'loss': 0.9765, 'grad_norm': 0.9875397086143494, 'learning_rate': 0.0002, 'epoch': 0.68}\n",
+      "{'loss': 0.9106, 'grad_norm': 0.17126591503620148, 'learning_rate': 0.0002, 'epoch': 0.68}\n",
+      "{'loss': 0.8921, 'grad_norm': 0.6837141513824463, 'learning_rate': 0.0002, 'epoch': 0.68}\n",
+      "{'loss': 0.8754, 'grad_norm': 0.189344584941864, 'learning_rate': 0.0002, 'epoch': 0.68}\n",
+      "{'loss': 0.8558, 'grad_norm': 1.0515497922897339, 'learning_rate': 0.0002, 'epoch': 0.69}\n",
+      "{'loss': 0.9529, 'grad_norm': 0.1749449074268341, 'learning_rate': 0.0002, 'epoch': 0.69}\n",
+      "{'loss': 0.896, 'grad_norm': 0.6071354746818542, 'learning_rate': 0.0002, 'epoch': 0.69}\n",
+      "{'loss': 0.9312, 'grad_norm': 0.18292884528636932, 'learning_rate': 0.0002, 'epoch': 0.69}\n",
+      "{'loss': 0.8876, 'grad_norm': nan, 'learning_rate': 0.0002, 'epoch': 0.69}\n",
+      "{'loss': 1.0023, 'grad_norm': 0.17327187955379486, 'learning_rate': 0.0002, 'epoch': 0.7}\n",
+      "{'loss': 0.9034, 'grad_norm': 0.6923970580101013, 'learning_rate': 0.0002, 'epoch': 0.7}\n",
+      "{'loss': 0.9337, 'grad_norm': 0.1671680212020874, 'learning_rate': 0.0002, 'epoch': 0.7}\n",
+      "{'loss': 0.9213, 'grad_norm': 0.5962586402893066, 'learning_rate': 0.0002, 'epoch': 0.7}\n",
+      "{'loss': 0.9583, 'grad_norm': 0.17949602007865906, 'learning_rate': 0.0002, 'epoch': 0.71}\n",
+      "{'loss': 0.8819, 'grad_norm': 0.6346273422241211, 'learning_rate': 0.0002, 'epoch': 0.71}\n",
+      "{'loss': 1.0111, 'grad_norm': 0.16367392241954803, 'learning_rate': 0.0002, 'epoch': 0.71}\n",
+      "{'loss': 1.0134, 'grad_norm': 0.9255533218383789, 'learning_rate': 0.0002, 'epoch': 0.71}\n",
+      "{'loss': 0.9786, 'grad_norm': 0.18210674822330475, 'learning_rate': 0.0002, 'epoch': 0.72}\n",
+      "{'loss': 0.8756, 'grad_norm': 0.6130886673927307, 'learning_rate': 0.0002, 'epoch': 0.72}\n",
+      "{'loss': 0.9992, 'grad_norm': 0.18911626935005188, 'learning_rate': 0.0002, 'epoch': 0.72}\n",
+      "{'loss': 0.896, 'grad_norm': 0.7793257236480713, 'learning_rate': 0.0002, 'epoch': 0.72}\n",
+      "{'loss': 0.926, 'grad_norm': 0.18797841668128967, 'learning_rate': 0.0002, 'epoch': 0.73}\n",
+      "{'loss': 0.8785, 'grad_norm': 0.6364346742630005, 'learning_rate': 0.0002, 'epoch': 0.73}\n",
+      "{'loss': 0.8948, 'grad_norm': 0.16828393936157227, 'learning_rate': 0.0002, 'epoch': 0.73}\n",
+      "{'loss': 0.9487, 'grad_norm': 0.6867016553878784, 'learning_rate': 0.0002, 'epoch': 0.73}\n",
+      "{'loss': 0.8766, 'grad_norm': 0.18466168642044067, 'learning_rate': 0.0002, 'epoch': 0.74}\n",
+      "{'loss': 0.8801, 'grad_norm': 0.6138403415679932, 'learning_rate': 0.0002, 'epoch': 0.74}\n",
+      "{'loss': 0.8444, 'grad_norm': 0.1989549696445465, 'learning_rate': 0.0002, 'epoch': 0.74}\n",
+      "{'loss': 0.9017, 'grad_norm': 0.43768447637557983, 'learning_rate': 0.0002, 'epoch': 0.74}\n",
+      "{'loss': 0.9353, 'grad_norm': 0.1687244474887848, 'learning_rate': 0.0002, 'epoch': 0.75}\n",
+      "{'loss': 0.9284, 'grad_norm': 0.7860745191574097, 'learning_rate': 0.0002, 'epoch': 0.75}\n",
+      "{'loss': 0.9401, 'grad_norm': 0.18997110426425934, 'learning_rate': 0.0002, 'epoch': 0.75}\n",
+      "{'loss': 0.8903, 'grad_norm': 0.5931161642074585, 'learning_rate': 0.0002, 'epoch': 0.76}\n",
+      "{'loss': 0.9926, 'grad_norm': 0.20726624131202698, 'learning_rate': 0.0002, 'epoch': 0.76}\n",
+      "{'loss': 0.9248, 'grad_norm': 0.6545441746711731, 'learning_rate': 0.0002, 'epoch': 0.76}\n",
+      "{'loss': 0.9821, 'grad_norm': 0.25480008125305176, 'learning_rate': 0.0002, 'epoch': 0.76}\n",
+      "{'loss': 0.9686, 'grad_norm': 1.0328234434127808, 'learning_rate': 0.0002, 'epoch': 0.77}\n",
+      "{'loss': 0.879, 'grad_norm': 0.14962701499462128, 'learning_rate': 0.0002, 'epoch': 0.77}\n",
+      "{'loss': 0.8798, 'grad_norm': 0.7034680247306824, 'learning_rate': 0.0002, 'epoch': 0.77}\n",
+      "{'loss': 0.9307, 'grad_norm': 0.16955070197582245, 'learning_rate': 0.0002, 'epoch': 0.77}\n",
+      "{'loss': 0.916, 'grad_norm': 1.065596103668213, 'learning_rate': 0.0002, 'epoch': 0.78}\n",
+      "{'loss': 0.9222, 'grad_norm': 0.18027226626873016, 'learning_rate': 0.0002, 'epoch': 0.78}\n",
+      "{'loss': 0.9173, 'grad_norm': 1.4714555740356445, 'learning_rate': 0.0002, 'epoch': 0.78}\n",
+      "{'loss': 0.9917, 'grad_norm': 0.18239441514015198, 'learning_rate': 0.0002, 'epoch': 0.78}\n",
+      "{'loss': 0.898, 'grad_norm': 0.517456591129303, 'learning_rate': 0.0002, 'epoch': 0.79}\n",
+      "{'loss': 0.9155, 'grad_norm': 0.217670738697052, 'learning_rate': 0.0002, 'epoch': 0.79}\n",
+      "{'loss': 0.8688, 'grad_norm': 0.5475726127624512, 'learning_rate': 0.0002, 'epoch': 0.79}\n",
+      "{'loss': 0.918, 'grad_norm': 0.18946382403373718, 'learning_rate': 0.0002, 'epoch': 0.79}\n",
+      "{'loss': 0.8633, 'grad_norm': 0.7255657911300659, 'learning_rate': 0.0002, 'epoch': 0.8}\n",
+      "{'loss': 0.866, 'grad_norm': 0.18645444512367249, 'learning_rate': 0.0002, 'epoch': 0.8}\n",
+      "{'loss': 0.8733, 'grad_norm': 0.5056295394897461, 'learning_rate': 0.0002, 'epoch': 0.8}\n",
+      "{'loss': 0.8974, 'grad_norm': 0.18203817307949066, 'learning_rate': 0.0002, 'epoch': 0.8}\n",
+      "{'loss': 0.8677, 'grad_norm': 0.6095141768455505, 'learning_rate': 0.0002, 'epoch': 0.81}\n",
+      "{'loss': 1.0509, 'grad_norm': 0.19236193597316742, 'learning_rate': 0.0002, 'epoch': 0.81}\n",
+      "{'loss': 0.9148, 'grad_norm': 1.3525644540786743, 'learning_rate': 0.0002, 'epoch': 0.81}\n",
+      "{'loss': 1.0055, 'grad_norm': 0.18916131556034088, 'learning_rate': 0.0002, 'epoch': 0.81}\n",
+      "{'loss': 0.8966, 'grad_norm': 0.8199710845947266, 'learning_rate': 0.0002, 'epoch': 0.81}\n",
+      "{'loss': 0.9442, 'grad_norm': 0.1951441913843155, 'learning_rate': 0.0002, 'epoch': 0.82}\n",
+      "{'loss': 0.9492, 'grad_norm': 0.6091954112052917, 'learning_rate': 0.0002, 'epoch': 0.82}\n",
+      "{'loss': 0.9609, 'grad_norm': 0.1769188493490219, 'learning_rate': 0.0002, 'epoch': 0.82}\n",
+      "{'loss': 0.9208, 'grad_norm': 0.9162861704826355, 'learning_rate': 0.0002, 'epoch': 0.82}\n",
+      "{'loss': 0.9887, 'grad_norm': 0.20802035927772522, 'learning_rate': 0.0002, 'epoch': 0.83}\n",
+      "{'loss': 0.8363, 'grad_norm': 0.5279651880264282, 'learning_rate': 0.0002, 'epoch': 0.83}\n",
+      "{'loss': 0.8666, 'grad_norm': 0.1835375428199768, 'learning_rate': 0.0002, 'epoch': 0.83}\n",
+      "{'loss': 0.8305, 'grad_norm': 0.5539934635162354, 'learning_rate': 0.0002, 'epoch': 0.83}\n",
+      "{'loss': 0.9216, 'grad_norm': 0.20207300782203674, 'learning_rate': 0.0002, 'epoch': 0.84}\n",
+      "{'loss': 0.9254, 'grad_norm': 0.7844143509864807, 'learning_rate': 0.0002, 'epoch': 0.84}\n",
+      "{'loss': 0.8994, 'grad_norm': 0.18322011828422546, 'learning_rate': 0.0002, 'epoch': 0.84}\n",
+      "{'loss': 0.9087, 'grad_norm': 0.6830234527587891, 'learning_rate': 0.0002, 'epoch': 0.84}\n",
+      "{'loss': 0.9709, 'grad_norm': 0.2566700577735901, 'learning_rate': 0.0002, 'epoch': 0.85}\n",
+      "{'loss': 0.8976, 'grad_norm': 0.5871272683143616, 'learning_rate': 0.0002, 'epoch': 0.85}\n",
+      "{'loss': 0.9833, 'grad_norm': 0.20046353340148926, 'learning_rate': 0.0002, 'epoch': 0.85}\n",
+      "{'loss': 0.9446, 'grad_norm': 0.8520637154579163, 'learning_rate': 0.0002, 'epoch': 0.85}\n",
+      "{'loss': 0.92, 'grad_norm': 0.16517290472984314, 'learning_rate': 0.0002, 'epoch': 0.86}\n",
+      "{'loss': 0.9125, 'grad_norm': 0.6205738186836243, 'learning_rate': 0.0002, 'epoch': 0.86}\n",
+      "{'loss': 0.9475, 'grad_norm': 0.17634056508541107, 'learning_rate': 0.0002, 'epoch': 0.86}\n",
+      "{'loss': 0.9743, 'grad_norm': nan, 'learning_rate': 0.0002, 'epoch': 0.86}\n",
+      "{'loss': 0.8723, 'grad_norm': 0.17945894598960876, 'learning_rate': 0.0002, 'epoch': 0.87}\n",
+      "{'loss': 0.928, 'grad_norm': 0.702457070350647, 'learning_rate': 0.0002, 'epoch': 0.87}\n",
+      "{'loss': 0.9515, 'grad_norm': 0.18701902031898499, 'learning_rate': 0.0002, 'epoch': 0.87}\n",
+      "{'loss': 0.9626, 'grad_norm': 1.8034521341323853, 'learning_rate': 0.0002, 'epoch': 0.88}\n",
+      "{'loss': 1.0129, 'grad_norm': 0.1699250042438507, 'learning_rate': 0.0002, 'epoch': 0.88}\n",
+      "{'loss': 0.8649, 'grad_norm': 1.4398291110992432, 'learning_rate': 0.0002, 'epoch': 0.88}\n",
+      "{'loss': 0.9602, 'grad_norm': 0.22786056995391846, 'learning_rate': 0.0002, 'epoch': 0.88}\n",
+      "{'loss': 0.9143, 'grad_norm': 0.6825014352798462, 'learning_rate': 0.0002, 'epoch': 0.89}\n",
+      "{'loss': 0.9184, 'grad_norm': 0.16519026458263397, 'learning_rate': 0.0002, 'epoch': 0.89}\n",
+      "{'loss': 0.8747, 'grad_norm': 1.3449418544769287, 'learning_rate': 0.0002, 'epoch': 0.89}\n",
+      "{'loss': 0.9087, 'grad_norm': 0.1671295315027237, 'learning_rate': 0.0002, 'epoch': 0.89}\n",
+      "{'loss': 0.8346, 'grad_norm': 0.8271273970603943, 'learning_rate': 0.0002, 'epoch': 0.9}\n",
+      "{'loss': 0.9763, 'grad_norm': 0.17928583920001984, 'learning_rate': 0.0002, 'epoch': 0.9}\n",
+      "{'loss': 0.8836, 'grad_norm': 0.6799443364143372, 'learning_rate': 0.0002, 'epoch': 0.9}\n",
+      "{'loss': 0.9549, 'grad_norm': 0.1991557776927948, 'learning_rate': 0.0002, 'epoch': 0.9}\n",
+      "{'loss': 0.8142, 'grad_norm': 1.6284645795822144, 'learning_rate': 0.0002, 'epoch': 0.91}\n",
+      "{'loss': 0.9642, 'grad_norm': 0.1723521649837494, 'learning_rate': 0.0002, 'epoch': 0.91}\n",
+      "{'loss': 0.8849, 'grad_norm': 0.9515684843063354, 'learning_rate': 0.0002, 'epoch': 0.91}\n",
+      "{'loss': 0.9041, 'grad_norm': 0.3376927971839905, 'learning_rate': 0.0002, 'epoch': 0.91}\n",
+      "{'loss': 0.86, 'grad_norm': 0.7406063079833984, 'learning_rate': 0.0002, 'epoch': 0.92}\n",
+      "{'loss': 0.9478, 'grad_norm': 0.2091047763824463, 'learning_rate': 0.0002, 'epoch': 0.92}\n",
+      "{'loss': 0.8889, 'grad_norm': 1.8721548318862915, 'learning_rate': 0.0002, 'epoch': 0.92}\n",
+      "{'loss': 0.9085, 'grad_norm': 0.17120325565338135, 'learning_rate': 0.0002, 'epoch': 0.92}\n",
+      "{'loss': 0.8514, 'grad_norm': 0.4665273427963257, 'learning_rate': 0.0002, 'epoch': 0.93}\n",
+      "{'loss': 0.9156, 'grad_norm': 0.1937875896692276, 'learning_rate': 0.0002, 'epoch': 0.93}\n",
+      "{'loss': 0.8687, 'grad_norm': 0.8680121898651123, 'learning_rate': 0.0002, 'epoch': 0.93}\n",
+      "{'loss': 0.8956, 'grad_norm': 0.2061094045639038, 'learning_rate': 0.0002, 'epoch': 0.93}\n",
+      "{'loss': 0.8947, 'grad_norm': 0.9933726191520691, 'learning_rate': 0.0002, 'epoch': 0.94}\n",
+      "{'loss': 0.9171, 'grad_norm': 0.19053538143634796, 'learning_rate': 0.0002, 'epoch': 0.94}\n",
+      "{'loss': 0.9059, 'grad_norm': 0.8791096210479736, 'learning_rate': 0.0002, 'epoch': 0.94}\n",
+      "{'loss': 0.8716, 'grad_norm': 0.2057473063468933, 'learning_rate': 0.0002, 'epoch': 0.94}\n",
+      "{'loss': 0.9404, 'grad_norm': 1.6940504312515259, 'learning_rate': 0.0002, 'epoch': 0.94}\n",
+      "{'loss': 0.9229, 'grad_norm': 0.16823047399520874, 'learning_rate': 0.0002, 'epoch': 0.95}\n",
+      "{'loss': 0.8754, 'grad_norm': 0.8294610977172852, 'learning_rate': 0.0002, 'epoch': 0.95}\n",
+      "{'loss': 0.8728, 'grad_norm': 0.24883323907852173, 'learning_rate': 0.0002, 'epoch': 0.95}\n",
+      "{'loss': 0.8487, 'grad_norm': 3.2656424045562744, 'learning_rate': 0.0002, 'epoch': 0.95}\n",
+      "{'loss': 0.9547, 'grad_norm': 0.19104239344596863, 'learning_rate': 0.0002, 'epoch': 0.96}\n",
+      "{'loss': 0.924, 'grad_norm': 0.7673139572143555, 'learning_rate': 0.0002, 'epoch': 0.96}\n",
+      "{'loss': 0.8618, 'grad_norm': 0.17888028919696808, 'learning_rate': 0.0002, 'epoch': 0.96}\n",
+      "{'loss': 0.9566, 'grad_norm': 0.8679395914077759, 'learning_rate': 0.0002, 'epoch': 0.96}\n",
+      "{'loss': 0.9086, 'grad_norm': 0.15006569027900696, 'learning_rate': 0.0002, 'epoch': 0.97}\n",
+      "{'loss': 0.8762, 'grad_norm': 0.555906355381012, 'learning_rate': 0.0002, 'epoch': 0.97}\n",
+      "{'loss': 0.8814, 'grad_norm': 0.18685294687747955, 'learning_rate': 0.0002, 'epoch': 0.97}\n",
+      "{'loss': 0.8735, 'grad_norm': 0.4058266282081604, 'learning_rate': 0.0002, 'epoch': 0.97}\n",
+      "{'loss': 0.9453, 'grad_norm': 0.1942286193370819, 'learning_rate': 0.0002, 'epoch': 0.98}\n",
+      "{'loss': 0.8863, 'grad_norm': 2.258617639541626, 'learning_rate': 0.0002, 'epoch': 0.98}\n",
+      "{'loss': 0.8871, 'grad_norm': 0.21025674045085907, 'learning_rate': 0.0002, 'epoch': 0.98}\n",
+      "{'loss': 0.904, 'grad_norm': 0.6984846591949463, 'learning_rate': 0.0002, 'epoch': 0.98}\n",
+      "{'loss': 0.8729, 'grad_norm': 0.2616581320762634, 'learning_rate': 0.0002, 'epoch': 0.99}\n",
+      "{'loss': 0.8947, 'grad_norm': 0.8359590172767639, 'learning_rate': 0.0002, 'epoch': 0.99}\n",
+      "{'loss': 0.8902, 'grad_norm': 0.1865774542093277, 'learning_rate': 0.0002, 'epoch': 0.99}\n",
+      "{'loss': 0.9036, 'grad_norm': 1.2092516422271729, 'learning_rate': 0.0002, 'epoch': 0.99}\n",
+      "{'loss': 0.9307, 'grad_norm': 0.21747666597366333, 'learning_rate': 0.0002, 'epoch': 1.0}\n",
+      "{'loss': 0.8399, 'grad_norm': 0.7714409828186035, 'learning_rate': 0.0002, 'epoch': 1.0}\n",
+      "{'train_runtime': 12820.6696, 'train_samples_per_second': 3.12, 'train_steps_per_second': 0.78, 'train_loss': 0.9340546731948852, 'epoch': 1.0}\n"
+     ]
+    }
+   ],
+   "source": [
+    "# start training, the model will be automatically saved to the hub and the output directory\n",
+    "trainer.train()\n",
+    "\n",
+    "# save model\n",
+    "trainer.save_model()"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 14,
+   "metadata": {},
+   "outputs": [
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "e6426296619347acb49628b93080e457",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "Upload 8 LFS files:   0%|          | 0/8 [00:00<?, ?it/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "3037c32d4606420daffc6344a6205688",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "adapter_model.safetensors:   0%|          | 0.00/36.1M [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "90b7aacf86cc48d5b4031867fcfea961",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "events.out.tfevents.1713414465.helios.8602.0:   0%|          | 0.00/5.15k [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "8d3ed09db7dc45a69d88b3c5a12a39bb",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "events.out.tfevents.1713414705.helios.9028.0:   0%|          | 0.00/5.15k [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "e2405593f1e44016a7f51c43507e80de",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "events.out.tfevents.1713414787.helios.9547.0:   0%|          | 0.00/5.15k [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "5f836feed84c45ab86e1816316f4c65b",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "events.out.tfevents.1713414905.helios.5100.0:   0%|          | 0.00/5.15k [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "13357555544f4e008d1cbf5cea425596",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "events.out.tfevents.1713414939.helios.5551.0:   0%|          | 0.00/5.15k [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "e5ae684663ed491a950aae5fb8526875",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "events.out.tfevents.1713415047.helios.5749.0:   0%|          | 0.00/89.9k [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "application/vnd.jupyter.widget-view+json": {
+       "model_id": "c9ef39ce62d543ab82d4da76954799ae",
+       "version_major": 2,
+       "version_minor": 0
+      },
+      "text/plain": [
+       "training_args.bin:   0%|          | 0.00/4.92k [00:00<?, ?B/s]"
+      ]
+     },
+     "metadata": {},
+     "output_type": "display_data"
+    },
+    {
+     "data": {
+      "text/plain": [
+       "CommitInfo(commit_url='https://huggingface.co/bgsmagnuson/tiny-llama-code-feedback/commit/fa28f0626aa8b0c1bdc1dbdbd217b352a8cf1c8d', commit_message='tiny-llama-code-feedback', commit_description='', oid='fa28f0626aa8b0c1bdc1dbdbd217b352a8cf1c8d', pr_url=None, pr_revision=None, pr_num=None)"
+      ]
+     },
+     "execution_count": 14,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
    "source": [
-    "trainer.model.save_pretrained(new_model)\n",
-    "trainer.tokenizer.save_pretrained(new_model)\n"
+    "trainer.push_to_hub(\"tiny-llama-code-feedback\")"
    ]
   },
   {
@@ -351,19 +803,18 @@
    "execution_count": null,
    "metadata": {},
    "outputs": [],
-   "source": [
-    "logging.set_verbosity(logging.CRITICAL)\n",
-    "\n",
-    "prompt = \"What is continuous integration?\"\n",
-    "pipe = pipeline(task=\"text-generation\", model=model, tokenizer=tokenizer, max_length=200)\n",
-    "result = pipe(f\"<s>[INST] {prompt} [/INST]\")\n",
-    "print(result[0]['generated_text'])"
-   ]
+   "source": []
   }
  ],
  "metadata": {
+  "accelerator": "GPU",
+  "colab": {
+   "gpuType": "T4",
+   "include_colab_link": true,
+   "provenance": []
+  },
   "kernelspec": {
-   "display_name": "venv",
+   "display_name": "Python 3 (ipykernel)",
    "language": "python",
    "name": "python3"
   },
@@ -381,5 +832,5 @@
   }
  },
  "nbformat": 4,
- "nbformat_minor": 2
+ "nbformat_minor": 0
 }
Index: .idea/LLM-Debug-Assistant.iml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<module type=\"PYTHON_MODULE\" version=\"4\">\n  <component name=\"NewModuleRootManager\">\n    <content url=\"file://$MODULE_DIR$\">\n      <excludeFolder url=\"file://$MODULE_DIR$/venv\" />\n    </content>\n    <orderEntry type=\"inheritedJdk\" />\n    <orderEntry type=\"sourceFolder\" forTests=\"false\" />\n  </component>\n</module>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/LLM-Debug-Assistant.iml b/.idea/LLM-Debug-Assistant.iml
--- a/.idea/LLM-Debug-Assistant.iml	(revision 08a978e83fc64941c7ddcf70c3e64f3eabb379e1)
+++ b/.idea/LLM-Debug-Assistant.iml	(date 1713485548927)
@@ -1,10 +1,15 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <module type="PYTHON_MODULE" version="4">
   <component name="NewModuleRootManager">
-    <content url="file://$MODULE_DIR$">
-      <excludeFolder url="file://$MODULE_DIR$/venv" />
-    </content>
+    <content url="file://$MODULE_DIR$" />
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
   </component>
+  <component name="PyDocumentationSettings">
+    <option name="format" value="PLAIN" />
+    <option name="myDocStringFormat" value="Plain" />
+  </component>
+  <component name="TestRunnerService">
+    <option name="PROJECT_TEST_RUNNER" value="py.test" />
+  </component>
 </module>
\ No newline at end of file
Index: requirements.txt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>jupyter\nipykernel\naccelerate \npeft \nbitsandbytes \ntransformers \ntrl\ntensorboard\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/requirements.txt b/requirements.txt
--- a/requirements.txt	(revision 08a978e83fc64941c7ddcf70c3e64f3eabb379e1)
+++ b/requirements.txt	(date 1713485499700)
@@ -6,3 +6,5 @@
 transformers 
 trl
 tensorboard
+evaluate
+flask
Index: server.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/server.py b/server.py
new file mode 100644
--- /dev/null	(date 1713485499702)
+++ b/server.py	(date 1713485499702)
@@ -0,0 +1,70 @@
+import socket
+import threading
+from transformers import AutoModelForCausalLM, AutoTokenizer
+import torch
+
+def generate_and_stream(model, input_ids, tokenizer, conn):
+    chat_history_ids = input_ids
+    model.eval()  # Make sure the model is in evaluation mode
+
+    with torch.no_grad():  # Disable gradient calculation for generation
+        for _ in range(200):  # Assuming a max length of 200 tokens
+            outputs = model(chat_history_ids)
+            next_token_logits = outputs.logits[:, -1, :]
+            next_token = torch.argmax(next_token_logits, dim=-1).unsqueeze(-1)
+            chat_history_ids = torch.cat([chat_history_ids, next_token], dim=1)
+
+            # Decode and send the token
+            next_token_str = tokenizer.decode(next_token[0], skip_special_tokens=True)
+            if next_token_str == tokenizer.eos_token:
+                conn.sendall("END".encode("utf-8"))  # Send a special end token to signify end of message
+                break
+
+            conn.sendall(next_token_str.encode("utf-8"))
+
+def client_thread(conn, addr, model, tokenizer):
+    print(f"Accepted connection from {addr[0]}:{addr[1]}")
+    try:
+        while True:
+            data = conn.recv(1024)
+            if not data:
+                break
+            request = data.decode("utf-8").strip()
+            print(f"Received: '{request}' from {addr}")
+
+            if request.lower() == "close":
+                conn.sendall("closed".encode("utf-8"))
+                break
+
+            input_ids = tokenizer.encode(request, return_tensors='pt')
+            generate_and_stream(model, input_ids, tokenizer, conn)
+
+    except Exception as e:
+        print(f"Error handling {addr}: {e}")
+    finally:
+        conn.close()
+        print(f"Closed connection with {addr}")
+
+def run_server():
+    server_ip = '127.0.0.1'
+    server_port = 8000
+    model_path = "llama-2-7b-chat-stack-overflow"
+    tokenizer = AutoTokenizer.from_pretrained(model_path)
+    model = AutoModelForCausalLM.from_pretrained(model_path)
+
+    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
+    server_socket.bind((server_ip, server_port))
+    server_socket.listen(5)
+    print(f"Server listening on {server_ip}:{server_port}")
+
+    try:
+        while True:
+            conn, addr = server_socket.accept()
+            threading.Thread(target=client_thread, args=(conn, addr, model, tokenizer)).start()
+    finally:
+        server_socket.close()
+        print("Server shutdown")
+
+
+# Run the server
+run_server()
Index: api.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/api.py b/api.py
new file mode 100644
--- /dev/null	(date 1713485499615)
+++ b/api.py	(date 1713485499615)
@@ -0,0 +1,28 @@
+from flask import Flask, request, jsonify
+from transformers import AutoModelForCausalLM, AutoTokenizer, pipeline
+
+app = Flask(__name__)
+
+# Load your fine-tuned model and tokenizer
+model_path = "llama-2-7b-chat-stack-overflow"
+tokenizer = AutoTokenizer.from_pretrained(model_path)
+model = AutoModelForCausalLM.from_pretrained(model_path)
+
+
+@app.route('/prompt', methods=['POST'])
+def prompt():
+    prompt = request.json['prompt']
+
+    pipe = pipeline(task="text-generation", model=model, tokenizer=tokenizer, max_length=200)
+    result = pipe(f"<s>[INST] {prompt} [/INST]")
+    response = result[0]['generated_text']
+
+    #reformat
+    idx = response.find("[/INST]") + 8
+    response = response[idx:]
+
+    return jsonify({'response': response})
+
+
+if __name__ == '__main__':
+    app.run(debug=True, port=9090)
Index: .gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># Byte-compiled / optimized / DLL files\n__pycache__/\n*.py[cod]\n*$py.class\n\n# C extensions\n*.so\n\n# Distribution / packaging\n.Python\nbuild/\ndevelop-eggs/\ndist/\ndownloads/\neggs/\n.eggs/\nlib/\nlib64/\nparts/\nsdist/\nvar/\nwheels/\nshare/python-wheels/\n*.egg-info/\n.installed.cfg\n*.egg\nMANIFEST\n\n# PyInstaller\n#  Usually these files are written by a python script from a template\n#  before PyInstaller builds the exe, so as to inject date/other infos into it.\n*.manifest\n*.spec\n\n# Installer logs\npip-log.txt\npip-delete-this-directory.txt\n\n# Unit test / coverage reports\nhtmlcov/\n.tox/\n.nox/\n.coverage\n.coverage.*\n.cache\nnosetests.xml\ncoverage.xml\n*.cover\n*.py,cover\n.hypothesis/\n.pytest_cache/\ncover/\n\n# Translations\n*.mo\n*.pot\n\n# Django stuff:\n*.log\nlocal_settings.py\ndb.sqlite3\ndb.sqlite3-journal\n\n# Flask stuff:\ninstance/\n.webassets-cache\n\n# Scrapy stuff:\n.scrapy\n\n# Sphinx documentation\ndocs/_build/\n\n# PyBuilder\n.pybuilder/\ntarget/\n\n# Jupyter Notebook\n.ipynb_checkpoints\n\n# IPython\nprofile_default/\nipython_config.py\n\n# pyenv\n#   For a library or package, you might want to ignore these files since the code is\n#   intended to run in multiple environments; otherwise, check them in:\n# .python-version\n\n# pipenv\n#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.\n#   However, in case of collaboration, if having platform-specific dependencies or dependencies\n#   having no cross-platform support, pipenv may install dependencies that don't work, or not\n#   install all needed dependencies.\n#Pipfile.lock\n\n# poetry\n#   Similar to Pipfile.lock, it is generally recommended to include poetry.lock in version control.\n#   This is especially recommended for binary packages to ensure reproducibility, and is more\n#   commonly ignored for libraries.\n#   https://python-poetry.org/docs/basic-usage/#commit-your-poetrylock-file-to-version-control\n#poetry.lock\n\n# pdm\n#   Similar to Pipfile.lock, it is generally recommended to include pdm.lock in version control.\n#pdm.lock\n#   pdm stores project-wide configurations in .pdm.toml, but it is recommended to not include it\n#   in version control.\n#   https://pdm.fming.dev/#use-with-ide\n.pdm.toml\n\n# PEP 582; used by e.g. github.com/David-OConnor/pyflow and github.com/pdm-project/pdm\n__pypackages__/\n\n# Celery stuff\ncelerybeat-schedule\ncelerybeat.pid\n\n# SageMath parsed files\n*.sage.py\n\n# Environments\n.env\n.venv\nenv/\nvenv/\nENV/\nenv.bak/\nvenv.bak/\n\n# Spyder project settings\n.spyderproject\n.spyproject\n\n# Rope project settings\n.ropeproject\n\n# mkdocs documentation\n/site\n\n# mypy\n.mypy_cache/\n.dmypy.json\ndmypy.json\n\n# Pyre type checker\n.pyre/\n\n# pytype static type analyzer\n.pytype/\n\n# Cython debug symbols\ncython_debug/\n\n# PyCharm\n#  JetBrains specific template is maintained in a separate JetBrains.gitignore that can\n#  be found at https://github.com/github/gitignore/blob/main/Global/JetBrains.gitignore\n#  and can be added to the global gitignore or merged into this file.  For a more nuclear\n#  option (not recommended) you can uncomment the following to ignore the entire idea folder.\n#.idea/\n\n# Generated models\nllama-2-7b-chat-guanaco/\n/results/\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.gitignore b/.gitignore
--- a/.gitignore	(revision 08a978e83fc64941c7ddcf70c3e64f3eabb379e1)
+++ b/.gitignore	(date 1713485499614)
@@ -161,4 +161,7 @@
 
 # Generated models
 llama-2-7b-chat-guanaco/
+llama-2-7b-chat-stack-overflow/
+tiny-llama-code-feedback/
 /results/
+*.zip
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
new file mode 100644
--- /dev/null	(date 1713485579000)
+++ b/.idea/workspace.xml	(date 1713485579000)
@@ -0,0 +1,189 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="AutoImportSettings">
+    <option name="autoReloadType" value="SELECTIVE" />
+  </component>
+  <component name="ChangeListManager">
+    <list default="true" id="104a5890-8f45-434e-a580-fc68488de9bc" name="Changes" comment="">
+      <change afterPath="$PROJECT_DIR$/.idea/inspectionProfiles/profiles_settings.xml" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/api.py" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/llama-2-7b-chat-stack-overflow.zip" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/mock_client.py" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/run.ipynb" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/server.py" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.gitignore" beforeDir="false" afterPath="$PROJECT_DIR$/.gitignore" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/LLM-Debug-Assistant.iml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/LLM-Debug-Assistant.iml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/misc.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/misc.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/main.ipynb" beforeDir="false" afterPath="$PROJECT_DIR$/main.ipynb" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/requirements.txt" beforeDir="false" afterPath="$PROJECT_DIR$/requirements.txt" afterDir="false" />
+    </list>
+    <option name="SHOW_DIALOG" value="false" />
+    <option name="HIGHLIGHT_CONFLICTS" value="true" />
+    <option name="HIGHLIGHT_NON_ACTIVE_CHANGELIST" value="false" />
+    <option name="LAST_RESOLUTION" value="IGNORE" />
+  </component>
+  <component name="FileTemplateManagerImpl">
+    <option name="RECENT_TEMPLATES">
+      <list>
+        <option value="Jupyter Notebook" />
+        <option value="Python Script" />
+      </list>
+    </option>
+  </component>
+  <component name="FlaskConsoleOptions" custom-start-script="import sys&#10;sys.path.extend([WORKING_DIR_AND_PYTHON_PATHS])&#10;from flask.cli import ScriptInfo&#10;locals().update(ScriptInfo(create_app=None).load_app().make_shell_context())&#10;print(&quot;Python %s on %s\nApp: %s [%s]\nInstance: %s&quot; % (sys.version, sys.platform, app.import_name, app.env, app.instance_path))">
+    <envs>
+      <env key="FLASK_APP" value="app" />
+    </envs>
+    <option name="myCustomStartScript" value="import sys&#10;sys.path.extend([WORKING_DIR_AND_PYTHON_PATHS])&#10;from flask.cli import ScriptInfo&#10;locals().update(ScriptInfo(create_app=None).load_app().make_shell_context())&#10;print(&quot;Python %s on %s\nApp: %s [%s]\nInstance: %s&quot; % (sys.version, sys.platform, app.import_name, app.env, app.instance_path))" />
+    <option name="myEnvs">
+      <map>
+        <entry key="FLASK_APP" value="app" />
+      </map>
+    </option>
+  </component>
+  <component name="Git.Settings">
+    <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" />
+  </component>
+  <component name="MarkdownSettingsMigration">
+    <option name="stateVersion" value="1" />
+  </component>
+  <component name="ProjectColorInfo">{
+  &quot;associatedIndex&quot;: 0
+}</component>
+  <component name="ProjectId" id="2e0DitOtSsOqJIxL5JkLl11o9gE" />
+  <component name="ProjectLevelVcsManager">
+    <ConfirmationsSetting value="2" id="Add" />
+  </component>
+  <component name="ProjectViewState">
+    <option name="hideEmptyMiddlePackages" value="true" />
+    <option name="showLibraryContents" value="true" />
+  </component>
+  <component name="PropertiesComponent"><![CDATA[{
+  "keyToString": {
+    "ASKED_ADD_EXTERNAL_FILES": "true",
+    "ASKED_SHARE_PROJECT_CONFIGURATION_FILES": "true",
+    "Flask server.LLM-Debug-Assistant.executor": "Run",
+    "Python.bazinga.executor": "Run",
+    "Python.mock_client.executor": "Run",
+    "Python.server.executor": "Run",
+    "RunOnceActivity.OpenProjectViewOnStart": "true",
+    "RunOnceActivity.ShowReadmeOnStart": "true",
+    "SHARE_PROJECT_CONFIGURATION_FILES": "true",
+    "git-widget-placeholder": "Merging dev-brian",
+    "last_opened_file_path": "/Users/mesa/Coding Projects/LLM-Debug-Assistant",
+    "node.js.detected.package.eslint": "true",
+    "node.js.detected.package.tslint": "true",
+    "node.js.selected.package.eslint": "(autodetect)",
+    "node.js.selected.package.tslint": "(autodetect)",
+    "nodejs_package_manager_path": "npm",
+    "settings.editor.selected.configurable": "com.jetbrains.python.configuration.PyActiveSdkModuleConfigurable",
+    "vue.rearranger.settings.migration": "true"
+  }
+}]]></component>
+  <component name="RunManager" selected="Python.mock_client">
+    <configuration name="mock_client" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
+      <module name="LLM-Debug-Assistant" />
+      <option name="ENV_FILES" value="" />
+      <option name="INTERPRETER_OPTIONS" value="" />
+      <option name="PARENT_ENVS" value="true" />
+      <envs>
+        <env name="PYTHONUNBUFFERED" value="1" />
+      </envs>
+      <option name="SDK_HOME" value="" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
+      <option name="IS_MODULE_SDK" value="true" />
+      <option name="ADD_CONTENT_ROOTS" value="true" />
+      <option name="ADD_SOURCE_ROOTS" value="true" />
+      <EXTENSION ID="PythonCoverageRunConfigurationExtension" runner="coverage.py" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/mock_client.py" />
+      <option name="PARAMETERS" value="" />
+      <option name="SHOW_COMMAND_LINE" value="false" />
+      <option name="EMULATE_TERMINAL" value="false" />
+      <option name="MODULE_MODE" value="false" />
+      <option name="REDIRECT_INPUT" value="false" />
+      <option name="INPUT_FILE" value="" />
+      <method v="2" />
+    </configuration>
+    <configuration name="server" type="PythonConfigurationType" factoryName="Python" temporary="true" nameIsGenerated="true">
+      <module name="LLM-Debug-Assistant" />
+      <option name="ENV_FILES" value="" />
+      <option name="INTERPRETER_OPTIONS" value="" />
+      <option name="PARENT_ENVS" value="true" />
+      <envs>
+        <env name="PYTHONUNBUFFERED" value="1" />
+      </envs>
+      <option name="SDK_HOME" value="" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
+      <option name="IS_MODULE_SDK" value="true" />
+      <option name="ADD_CONTENT_ROOTS" value="true" />
+      <option name="ADD_SOURCE_ROOTS" value="true" />
+      <EXTENSION ID="PythonCoverageRunConfigurationExtension" runner="coverage.py" />
+      <option name="SCRIPT_NAME" value="$PROJECT_DIR$/server.py" />
+      <option name="PARAMETERS" value="" />
+      <option name="SHOW_COMMAND_LINE" value="false" />
+      <option name="EMULATE_TERMINAL" value="false" />
+      <option name="MODULE_MODE" value="false" />
+      <option name="REDIRECT_INPUT" value="false" />
+      <option name="INPUT_FILE" value="" />
+      <method v="2" />
+    </configuration>
+    <configuration name="LLM-Debug-Assistant" type="Python.FlaskServer">
+      <module name="LLM-Debug-Assistant" />
+      <option name="target" value="$PROJECT_DIR$/api.py" />
+      <option name="targetType" value="PATH" />
+      <option name="ENV_FILES" value="" />
+      <option name="INTERPRETER_OPTIONS" value="" />
+      <option name="PARENT_ENVS" value="true" />
+      <option name="SDK_HOME" value="" />
+      <option name="WORKING_DIRECTORY" value="$PROJECT_DIR$" />
+      <option name="IS_MODULE_SDK" value="false" />
+      <option name="ADD_CONTENT_ROOTS" value="true" />
+      <option name="ADD_SOURCE_ROOTS" value="true" />
+      <EXTENSION ID="PythonCoverageRunConfigurationExtension" runner="coverage.py" />
+      <option name="launchJavascriptDebuger" value="false" />
+      <method v="2" />
+    </configuration>
+    <recent_temporary>
+      <list>
+        <item itemvalue="Python.mock_client" />
+        <item itemvalue="Python.server" />
+      </list>
+    </recent_temporary>
+  </component>
+  <component name="SharedIndexes">
+    <attachedChunks>
+      <set>
+        <option value="bundled-python-sdk-09665e90c3a7-b11f5e8da5ad-com.jetbrains.pycharm.pro.sharedIndexes.bundled-PY-233.15026.15" />
+      </set>
+    </attachedChunks>
+  </component>
+  <component name="SpellCheckerSettings" RuntimeDictionaries="0" Folders="0" CustomDictionaries="0" DefaultDictionary="application-level" UseSingleDictionary="true" transferred="true" />
+  <component name="TaskManager">
+    <task active="true" id="Default" summary="Default task">
+      <changelist id="104a5890-8f45-434e-a580-fc68488de9bc" name="Changes" comment="" />
+      <created>1711047461558</created>
+      <option name="number" value="Default" />
+      <option name="presentableId" value="Default" />
+      <updated>1711047461558</updated>
+      <workItem from="1711047462572" duration="161000" />
+      <workItem from="1711047997336" duration="219000" />
+      <workItem from="1712010156903" duration="1979000" />
+      <workItem from="1712092939979" duration="321000" />
+      <workItem from="1712770615174" duration="7539000" />
+      <workItem from="1712781855002" duration="34000" />
+      <workItem from="1713290837252" duration="5000" />
+      <workItem from="1713302366128" duration="5103000" />
+    </task>
+    <servers />
+  </component>
+  <component name="TypeScriptGeneratedFilesManager">
+    <option name="version" value="3" />
+  </component>
+  <component name="com.intellij.coverage.CoverageDataManagerImpl">
+    <SUITE FILE_PATH="coverage/LLM_Debug_Assistant$mock_client.coverage" NAME="mock_client Coverage Results" MODIFIED="1713307382317" SOURCE_PROVIDER="com.intellij.coverage.DefaultCoverageFileProvider" RUNNER="coverage.py" COVERAGE_BY_TEST_ENABLED="true" COVERAGE_TRACING_ENABLED="false" WORKING_DIRECTORY="$PROJECT_DIR$" />
+    <SUITE FILE_PATH="coverage/LLM_Debug_Assistant$server.coverage" NAME="server Coverage Results" MODIFIED="1713307191445" SOURCE_PROVIDER="com.intellij.coverage.DefaultCoverageFileProvider" RUNNER="coverage.py" COVERAGE_BY_TEST_ENABLED="true" COVERAGE_TRACING_ENABLED="false" WORKING_DIRECTORY="$PROJECT_DIR$" />
+    <SUITE FILE_PATH="coverage/LLM_Debug_Assistant$bazinga.coverage" NAME="bazinga Coverage Results" MODIFIED="1711048010028" SOURCE_PROVIDER="com.intellij.coverage.DefaultCoverageFileProvider" RUNNER="coverage.py" COVERAGE_BY_TEST_ENABLED="true" COVERAGE_TRACING_ENABLED="false" WORKING_DIRECTORY="$PROJECT_DIR$" />
+    <SUITE FILE_PATH="coverage/LLM_Debug_Assistant$LLM_Debug_Assistant.coverage" NAME="LLM-Debug-Assistant Coverage Results" MODIFIED="1713305009824" SOURCE_PROVIDER="com.intellij.coverage.DefaultCoverageFileProvider" RUNNER="coverage.py" COVERAGE_BY_TEST_ENABLED="true" COVERAGE_TRACING_ENABLED="false" WORKING_DIRECTORY="$PROJECT_DIR$" />
+  </component>
+</project>
\ No newline at end of file
Index: run.ipynb
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/run.ipynb b/run.ipynb
new file mode 100644
--- /dev/null	(date 1713485499700)
+++ b/run.ipynb	(date 1713485499700)
@@ -0,0 +1,154 @@
+{
+ "cells": [
+  {
+   "cell_type": "code",
+   "execution_count": 1,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "from transformers import pipeline"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 2,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "model_name = \"bgsmagnuson/tiny-llama-code-feedback\""
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 3,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "generator = pipeline(\"text-generation\", model=model_name)"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 7,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "messages = [\n",
+    "    {\n",
+    "        \"role\": \"user\",\n",
+    "        \"content\": \"Loop through an array in Java\"\n",
+    "    }\n",
+    "]"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 8,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "# prompt = \"How do you print 'Hello, World!' in Java?\"\n",
+    "prompt = generator.tokenizer.apply_chat_template(messages, tokenize=False, add_generation_prompt=False)"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 9,
+   "metadata": {},
+   "outputs": [
+    {
+     "name": "stdout",
+     "output_type": "stream",
+     "text": [
+      "<|user|>\n",
+      "Loop through an array in Java</s>\n",
+      "<|assistant|>\n",
+      "Yes, you can loop through an array in Java using the for loop. Here's an example:\n",
+      "\n",
+      "```java\n",
+      "int[] numbers = {1, 2, 3, 4, 5};\n",
+      "\n",
+      "for (int number : numbers) {\n",
+      "    System.out.println(number);\n",
+      "}\n",
+      "```\n",
+      "\n",
+      "This code will print out the numbers in the array, one by one.\n",
+      "\n",
+      "You can also use the for loop to iterate over a range of numbers, such as from 0 to 10:\n",
+      "\n",
+      "```java\n",
+      "int[] numbers = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n",
+      "\n",
+      "for (int number : numbers) {\n",
+      "    System.out.println(number);\n",
+      "}\n",
+      "```\n",
+      "\n",
+      "This code will print out each number in the array, starting from 0 and ending at 10.\n",
+      "\n",
+      "You can also use the for loop to iterate over a range of numbers, and perform some action on each iteration:\n",
+      "\n",
+      "```java\n",
+      "int[] numbers = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n",
+      "\n",
+      "for (int number : numbers) {\n",
+      "    if (number % 2 == 0) {\n",
+      "        System.out.println(number);\n",
+      "    }\n",
+      "}\n",
+      "```\n",
+      "\n",
+      "This code will print out each even number in the array, starting from 0 and ending at 8.\n",
+      "\n",
+      "You can also use the for loop to iterate over a range of numbers, and perform some action on each iteration, and then update a variable based on the result:\n",
+      "\n",
+      "```java\n",
+      "int[] numbers = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n",
+      "\n",
+      "int sum = 0;\n",
+      "\n",
+      "for (int number : numbers) {\n",
+      "    sum += number;\n",
+      "}\n",
+      "\n",
+      "System.out.println(\"The sum of the even numbers in the array is: \" + sum);\n",
+      "```\n",
+      "\n",
+      "This code will print out the sum of the even numbers\n"
+     ]
+    }
+   ],
+   "source": [
+    "generated_text = generator(prompt, max_length=500)[0][\"generated_text\"]\n",
+    "print(generated_text)"
+   ]
+  },
+  {
+   "cell_type": "markdown",
+   "metadata": {},
+   "source": []
+  }
+ ],
+ "metadata": {
+  "kernelspec": {
+   "display_name": "venv",
+   "language": "python",
+   "name": "python3"
+  },
+  "language_info": {
+   "codemirror_mode": {
+    "name": "ipython",
+    "version": 3
+   },
+   "file_extension": ".py",
+   "mimetype": "text/x-python",
+   "name": "python",
+   "nbconvert_exporter": "python",
+   "pygments_lexer": "ipython3",
+   "version": "3.10.12"
+  }
+ },
+ "nbformat": 4,
+ "nbformat_minor": 2
+}
Index: .idea/inspectionProfiles/profiles_settings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/inspectionProfiles/profiles_settings.xml b/.idea/inspectionProfiles/profiles_settings.xml
new file mode 100644
--- /dev/null	(date 1713485499615)
+++ b/.idea/inspectionProfiles/profiles_settings.xml	(date 1713485499615)
@@ -0,0 +1,6 @@
+<component name="InspectionProjectProfileManager">
+  <settings>
+    <option name="USE_PROJECT_PROFILE" value="false" />
+    <version value="1.0" />
+  </settings>
+</component>
\ No newline at end of file
